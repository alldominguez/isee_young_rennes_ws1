<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Charline Warembourg, Maximilien Genard-Walton, Alan Domínguez, Augusto Anguita">
<meta name="dcterms.date" content="2024-05-28">

<title>ISEE young - Workshop 1. Statistical methods for studying mixtures and the exposome</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="isee_young_exposome_mixtures_files/libs/clipboard/clipboard.min.js"></script>
<script src="isee_young_exposome_mixtures_files/libs/quarto-html/quarto.js"></script>
<script src="isee_young_exposome_mixtures_files/libs/quarto-html/popper.min.js"></script>
<script src="isee_young_exposome_mixtures_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="isee_young_exposome_mixtures_files/libs/quarto-html/anchor.min.js"></script>
<link href="isee_young_exposome_mixtures_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="isee_young_exposome_mixtures_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="isee_young_exposome_mixtures_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="isee_young_exposome_mixtures_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="isee_young_exposome_mixtures_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ISEE young - Workshop 1. Statistical methods for studying mixtures and the exposome</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Charline Warembourg, Maximilien Genard-Walton, Alan Domínguez, Augusto Anguita </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p><img src="https://github.com/alldominguez/isee_young_rennes_ws1/blob/main/figures/logo_isse_young_rennes.PNG?raw=1" alt="ISGlobal logo" width="900"></p>
<p>The study of mixtures and the exposome in the context of environmental epidemiological research is rapidly growing. Investigating mixtures and the exposome allows researchers to assess the independent and combined effects of various exposures, as well as their potential synergistic or antagonistic effects, on health outcomes. However, the complexity of exploring these questions requires the use of specific statistical models to account for aspects that single-exposure models cannot typically handle (e.g.&nbsp;multicollinearity).</p>
<p>This workshop therefore aims at summarizing and presenting the main models used for studying mixtures and the exposome, and discussing the pros and cons of each method in relation to a specific study objectives.</p>
<p>To install the packaged required for the practical session please follow the steps below:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(Biobase, mice, MultiDataSet, lsr, FactoMiner,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>               stingr, circlize, reshape2, pryr, scales, imputeLCMD,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>               scatterplot3d, glmnet, gridExtra, grid, Hmisc, gplot,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>               gtools, S4Vectors, tidyverse, corrplot, RColorBrewer,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>               skimr, bkmr, gWQS, ggridges, MASS, caret, partDSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this hands-on session we will use data from the HELIX exposome study. The HELIX study is a collaborative project between six population-based longitudinal birth cohort studies from six European countries (France, Greece, Lithuania, Norway, Spain and the United Kingdom).</p>
<p><img src="https://github.com/alldominguez/isee_young_rennes_ws1/blob/main/figures/HELIX.png?raw=1" alt="HELIX logo" width="600"></p>
<p><strong>Note:</strong> The data provided in this introductory course were simulated using data from the HELIX subcohort. Details of the HELIX project and the origin of the data collected can be consulted in the following publication: https://bmjopen.bmj.com/content/8/9/e021311 and website: https://www.projecthelix.eu/es.</p>
<ul>
<li>The <strong>exposome data (n = 1301)</strong> that we will use is contained in an Rdata file, the file contains the following files:</li>
</ul>
<ol type="1">
<li><code>phenotype</code> (outcomes)</li>
<li><code>exposome</code></li>
<li><code>covariates</code> (covariates)</li>
</ol>
<p>The <code>exposome</code> database contains more than <strong>200 exposures</strong>. <img src="https://github.com/alldominguez/isee_young_rennes_ws1/blob/main/figures/HELIX_exposures.png?raw=1" alt="HELIX exposures" width="700"></p>
<p>The description of each variable (name, structure, variable type, transformation, …) is detailed in the <a href="https://github.com/alldominguez/isee_young_rennes/blob/main/data/codebook.csv">codebook</a>.</p>
<ul>
<li>This RData file contains (phenotype, exposure, covariates and codebook)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://raw.githubusercontent.com/alldominguez/isee_young_rennes_ws1/main/data/exposome.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will check the different options</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(phenotype) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,301
Columns: 7
$ ID               &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16…
$ e3_bw            &lt;int&gt; 4100, 4158, 4110, 3270, 3950, 2900, 3350, 3580, 3000,…
$ hs_asthma        &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0,…
$ hs_zbmi_who      &lt;dbl&gt; 0.30, 0.41, 3.33, -0.76, 0.98, -0.08, 0.04, -0.10, -1…
$ hs_correct_raven &lt;int&gt; 18, 25, 13, 28, 19, 19, 34, 16, 35, 32, 18, 24, 30, 3…
$ hs_Gen_Tot       &lt;dbl&gt; 84.0000, 39.0000, 40.0000, 54.5000, 18.0000, 4.0000, …
$ hs_bmi_c_cat     &lt;fct&gt; 2, 2, 4, 2, 2, 2, 2, 2, 2, 3, 4, 4, 2, 2, 4, 3, 2, 2,…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(exposome) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,301
Columns: 223
$ ID                           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13…
$ h_abs_ratio_preg_Log         &lt;dbl&gt; 0.89671105, 0.89253797, 0.77872299, 0.089…
$ h_no2_ratio_preg_Log         &lt;dbl&gt; 2.872304, 2.980008, 3.056501, 3.089157, 3…
$ h_pm10_ratio_preg_None       &lt;dbl&gt; 25.94850, 25.89774, 26.08735, 14.99138, 3…
$ h_pm25_ratio_preg_None       &lt;dbl&gt; 17.433798, 18.470850, 18.711547, 16.40977…
$ hs_no2_dy_hs_h_Log           &lt;dbl&gt; 2.530279, 1.928600, 2.882591, 1.390750, 3…
$ hs_no2_wk_hs_h_Log           &lt;dbl&gt; 2.583284, 2.652479, 2.591756, 2.456717, 3…
$ hs_no2_yr_hs_h_Log           &lt;dbl&gt; 2.612098, 2.761064, 2.356163, 2.403247, 3…
$ hs_pm10_dy_hs_h_None         &lt;dbl&gt; 22.53583, 14.07776, 46.85910, 29.81744, 2…
$ hs_pm10_wk_hs_h_None         &lt;dbl&gt; 20.850005, 29.141274, 31.530981, 25.23277…
$ hs_pm10_yr_hs_h_None         &lt;dbl&gt; 31.39907, 31.25053, 27.51600, 23.96526, 2…
$ hs_pm25_dy_hs_h_None         &lt;dbl&gt; 16.950474, 11.155481, 28.454911, 4.624601…
$ hs_pm25_wk_hs_h_None         &lt;dbl&gt; 17.001157, 15.910697, 21.274005, 10.96794…
$ hs_pm25_yr_hs_h_None         &lt;dbl&gt; 18.395672, 17.735640, 16.808644, 12.72905…
$ hs_pm25abs_dy_hs_h_Log       &lt;dbl&gt; 0.09739716, -0.43039392, 0.91559425, -0.2…
$ hs_pm25abs_wk_hs_h_Log       &lt;dbl&gt; 0.07115366, 0.21428919, 0.71974438, -0.13…
$ hs_pm25abs_yr_hs_h_Log       &lt;dbl&gt; 0.32106365, 0.28149354, 0.09872019, 0.177…
$ h_accesslines300_preg_dic0   &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ h_accesspoints300_preg_Log   &lt;dbl&gt; 1.962937, 2.368356, 1.269931, 4.527757, 3…
$ h_builtdens300_preg_Sqrt     &lt;dbl&gt; 405.12310, 310.82760, 374.61057, 565.0784…
$ h_connind300_preg_Sqrt       &lt;dbl&gt; 1.886691, 6.535691, 6.257448, 14.491952, …
$ h_fdensity300_preg_Log       &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 13.84635, 1…
$ h_frichness300_preg_None     &lt;dbl&gt; 0.00000000, 0.00000000, 0.00000000, 0.245…
$ h_landuseshan300_preg_None   &lt;dbl&gt; 0.3638871, 0.4007151, 0.2881437, 0.632757…
$ h_popdens_preg_Sqrt          &lt;dbl&gt; 84.988234, 84.988234, 84.988234, 66.53570…
$ h_walkability_mean_preg_None &lt;dbl&gt; 0.175, 0.200, 0.150, 0.350, 0.275, 0.350,…
$ hs_accesslines300_h_dic0     &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ hs_accesspoints300_h_Log     &lt;dbl&gt; 1.6753021, 2.7737896, 0.5770643, 4.583846…
$ hs_builtdens300_h_Sqrt       &lt;dbl&gt; 406.51919, 382.52734, 374.66924, 479.9022…
$ hs_connind300_h_Log          &lt;dbl&gt; 4.565486, 3.754556, 2.879087, 5.474342, 4…
$ hs_fdensity300_h_Log         &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 13.97641, 1…
$ hs_landuseshan300_h_None     &lt;dbl&gt; 0.3535060, 0.3205542, 0.4792989, 0.454445…
$ hs_popdens_h_Sqrt            &lt;dbl&gt; 84.988234, 10.246951, 10.246951, 66.53570…
$ hs_walkability_mean_h_None   &lt;dbl&gt; 0.375, 0.200, 0.250, 0.525, 0.300, 0.375,…
$ hs_accesslines300_s_dic0     &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ hs_accesspoints300_s_Log     &lt;dbl&gt; 0.5770643, 2.1860528, 2.1860528, 3.284590…
$ hs_builtdens300_s_Sqrt       &lt;dbl&gt; 384.99302, 383.64898, 366.41259, 406.2726…
$ hs_connind300_s_Log          &lt;dbl&gt; 2.368262, 3.466874, 3.977700, 5.651676, 4…
$ hs_fdensity300_s_Log         &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 12.34228, 1…
$ hs_landuseshan300_s_None     &lt;dbl&gt; 0.2800504, 0.3682542, 0.3252277, 0.520970…
$ hs_popdens_s_Sqrt            &lt;dbl&gt; 84.988234, 84.988234, 84.988234, 25.71451…
$ h_Absorbance_Log             &lt;dbl&gt; -0.135119353, -0.057699576, -0.437228805,…
$ h_Benzene_Log                &lt;dbl&gt; 0.57215704, 0.87975097, 1.37913427, 1.168…
$ h_NO2_Log                    &lt;dbl&gt; 4.576481, 3.368754, 4.297368, 2.504501, 6…
$ h_PM_Log                     &lt;dbl&gt; 2.604548, 2.328879, 2.327120, 1.657071, 3…
$ h_TEX_Log                    &lt;dbl&gt; 2.529664, 2.841000, 2.884071, 2.668584, 3…
$ e3_alcpreg_yn_None           &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1,…
$ h_bfdur_Ter                  &lt;fct&gt; "(0,10.8]", "(0,10.8]", "(34.9,Inf]", "(1…
$ h_cereal_preg_Ter            &lt;fct&gt; "(0,9]", "(0,9]", "(9,27.3]", "(27.3,Inf]…
$ h_dairy_preg_Ter             &lt;fct&gt; "(27.1,Inf]", "(27.1,Inf]", "(27.1,Inf]",…
$ h_fastfood_preg_Ter          &lt;fct&gt; "(0.25,0.83]", "(0.83,Inf]", "(0.83,Inf]"…
$ h_fish_preg_Ter              &lt;fct&gt; "(4.1,Inf]", "(4.1,Inf]", "(4.1,Inf]", "(…
$ h_folic_t1_None              &lt;fct&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,…
$ h_fruit_preg_Ter             &lt;fct&gt; "(0.6,18.2]", "(0.6,18.2]", "(0.6,18.2]",…
$ h_legume_preg_Ter            &lt;fct&gt; "(2,Inf]", "(2,Inf]", "(2,Inf]", "(2,Inf]…
$ h_meat_preg_Ter              &lt;fct&gt; "(6.5,10]", "(10,Inf]", "(6.5,10]", "(10,…
$ h_pamod_t3_None              &lt;fct&gt; Very Often, None, Often, Often, Very Ofte…
$ h_pavig_t3_None              &lt;fct&gt; Low, Low, Low, Medium, Medium, Medium, Lo…
$ h_veg_preg_Ter               &lt;fct&gt; "(8.8,16.5]", "(8.8,16.5]", "(8.8,16.5]",…
$ hs_bakery_prod_Ter           &lt;fct&gt; "(2,6]", "(0,2]", "(2,6]", "(6,Inf]", "(2…
$ hs_beverages_Ter             &lt;fct&gt; "(1,Inf]", "(0.132,1]", "(0.132,1]", "(0,…
$ hs_break_cer_Ter             &lt;fct&gt; "(0,1.1]", "(0,1.1]", "(1.1,5.5]", "(5.5,…
$ hs_caff_drink_Ter            &lt;fct&gt; "(0,0.132]", "(0.132,Inf]", "(0.132,Inf]"…
$ hs_dairy_Ter                 &lt;fct&gt; "(0,14.6]", "(0,14.6]", "(0,14.6]", "(25.…
$ hs_fastfood_Ter              &lt;fct&gt; "(0.132,0.5]", "(0.132,0.5]", "(0.132,0.5…
$ hs_KIDMED_None               &lt;dbl&gt; 2, 0, 1, 2, 4, 5, 2, 3, 3, 3, 3, 8, 2, 1,…
$ hs_mvpa_prd_alt_None         &lt;dbl&gt; 47.892043, 31.831901, 117.576830, -2.0334…
$ hs_org_food_Ter              &lt;fct&gt; "(0.132,1]", "(1,Inf]", "(0.132,1]", "(0.…
$ hs_pet_cat_r2_None           &lt;fct&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0,…
$ hs_pet_dog_r2_None           &lt;fct&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0,…
$ hs_pet_None                  &lt;fct&gt; Yes, No, No, Yes, Yes, Yes, Yes, No, Yes,…
$ hs_proc_meat_Ter             &lt;fct&gt; "(1.5,4]", "(1.5,4]", "(4,Inf]", "(0,1.5]…
$ hs_readymade_Ter             &lt;fct&gt; "(0,0.132]", "(0.5,Inf]", "(0.5,Inf]", "(…
$ hs_sd_wk_None                &lt;dbl&gt; 388.57143, 522.85714, 445.71429, 180.0000…
$ hs_total_bread_Ter           &lt;fct&gt; "(0,7]", "(17.5,Inf]", "(0,7]", "(17.5,In…
$ hs_total_cereal_Ter          &lt;fct&gt; "(0,14.1]", "(14.1,23.6]", "(14.1,23.6]",…
$ hs_total_fish_Ter            &lt;fct&gt; "(0,1.5]", "(0,1.5]", "(0,1.5]", "(1.5,3]…
$ hs_total_fruits_Ter          &lt;fct&gt; "(14.1,Inf]", "(0,7]", "(0,7]", "(14.1,In…
$ hs_total_lipids_Ter          &lt;fct&gt; "(7,Inf]", "(7,Inf]", "(7,Inf]", "(3,7]",…
$ hs_total_meat_Ter            &lt;fct&gt; "(6,9]", "(0,6]", "(9,Inf]", "(0,6]", "(6…
$ hs_total_potatoes_Ter        &lt;fct&gt; "(4,Inf]", "(3,4]", "(3,4]", "(0,3]", "(0…
$ hs_total_sweets_Ter          &lt;fct&gt; "(0,4.1]", "(8.5,Inf]", "(8.5,Inf]", "(8.…
$ hs_total_veg_Ter             &lt;fct&gt; "(8.5,Inf]", "(6,8.5]", "(8.5,Inf]", "(8.…
$ hs_total_yog_Ter             &lt;fct&gt; "(0,6]", "(0,6]", "(0,6]", "(8.5,Inf]", "…
$ hs_dif_hours_total_None      &lt;dbl&gt; 9.461109, 9.596343, 9.970835, 10.085262, …
$ hs_as_c_Log2                 &lt;dbl&gt; -4.28280856, -6.43028014, -7.97829150, 0.…
$ hs_as_m_Log2                 &lt;dbl&gt; -19.49712481, -9.58263737, -14.91793276, …
$ hs_cd_c_Log2                 &lt;dbl&gt; -4.140507, -4.254289, -4.051698, -5.25904…
$ hs_cd_m_Log2                 &lt;dbl&gt; -3.0709665, -2.5994621, -2.9657843, -0.93…
$ hs_co_c_Log2                 &lt;dbl&gt; 1.021480, -2.617056, -2.556393, -3.000000…
$ hs_co_m_Log2                 &lt;dbl&gt; -4.0831412, -2.4111954, -2.6259343, -2.80…
$ hs_cs_c_Log2                 &lt;dbl&gt; 0.2509616, 0.2016339, 0.3895668, 0.669026…
$ hs_cs_m_Log2                 &lt;dbl&gt; 0.1505597, -0.2722973, 0.5360529, 0.71369…
$ hs_cu_c_Log2                 &lt;dbl&gt; 9.710806, 9.943980, 9.929258, 10.192293, …
$ hs_cu_m_Log2                 &lt;dbl&gt; 10.216746, 10.511753, 10.264443, 10.09011…
$ hs_hg_c_Log2                 &lt;dbl&gt; -2.152003093, -1.300448367, -0.910501849,…
$ hs_hg_m_Log2                 &lt;dbl&gt; -3.12029423, -1.02326978, 0.08406426, 2.2…
$ hs_mn_c_Log2                 &lt;dbl&gt; 3.459432, 2.881665, 2.998196, 3.215679, 2…
$ hs_mn_m_Log2                 &lt;dbl&gt; 3.608809, 4.161888, 2.877744, 3.249445, 3…
$ hs_mo_c_Log2                 &lt;dbl&gt; 0.9486008, 1.0703893, -0.4839849, -5.8657…
$ hs_mo_m_Log2                 &lt;dbl&gt; -1.81096618, -2.41888982, -0.26534457, -0…
$ hs_pb_c_Log2                 &lt;dbl&gt; 3.632268, 3.405992, 2.815575, 3.168321, 3…
$ hs_pb_m_Log2                 &lt;dbl&gt; 2.604071, 3.817623, 3.158660, 2.575312, 3…
$ hs_tl_cdich_None             &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ hs_tl_mdich_None             &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ h_humidity_preg_None         &lt;dbl&gt; 89.91606, 82.19326, 86.88924, 77.91288, 7…
$ h_pressure_preg_None         &lt;dbl&gt; 981.4244, 982.8623, 980.8294, 1002.9952, …
$ h_temperature_preg_None      &lt;dbl&gt; 6.659455, 9.995885, 9.986814, 13.834848, …
$ hs_hum_mt_hs_h_None          &lt;dbl&gt; 79.29731, 85.55336, 81.89890, 81.72799, 5…
$ hs_tm_mt_hs_h_None           &lt;dbl&gt; 14.273439, 11.233588, 16.092377, 3.704591…
$ hs_uvdvf_mt_hs_h_None        &lt;dbl&gt; 0.13833333, 1.91900000, 1.66500000, 0.274…
$ hs_hum_dy_hs_h_None          &lt;dbl&gt; 54.44336, 70.39935, 77.63110, 47.68000, 5…
$ hs_hum_wk_hs_h_None          &lt;dbl&gt; 85.44951, 92.17720, 81.44176, 82.42149, 6…
$ hs_tm_dy_hs_h_None           &lt;dbl&gt; 17.1106000, 4.8696000, 16.8812000, 7.6062…
$ hs_tm_wk_hs_h_None           &lt;dbl&gt; 13.100794, 12.814309, 12.361921, 5.213848…
$ hs_uvdvf_dy_hs_h_None        &lt;dbl&gt; 2.60, 0.38, 1.59, 0.48, 2.89, 0.19, 0.44,…
$ hs_uvdvf_wk_hs_h_None        &lt;dbl&gt; 2.6871429, 0.4542857, 1.5828571, 0.437142…
$ hs_blueyn300_s_None          &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ h_blueyn300_preg_None        &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ h_greenyn300_preg_None       &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1,…
$ h_ndvi100_preg_None          &lt;dbl&gt; 0.4470029, 0.4812514, 0.4571000, 0.287485…
$ hs_greenyn300_s_None         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1,…
$ hs_blueyn300_h_None          &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ hs_greenyn300_h_None         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1,…
$ hs_ndvi100_h_None            &lt;dbl&gt; 0.4653917, 0.5239703, 0.5486595, 0.361057…
$ hs_ndvi100_s_None            &lt;dbl&gt; 0.4712486, 0.5292686, 0.5351938, 0.383908…
$ h_lden_cat_preg_None         &lt;dbl&gt; 39.75385, 49.16870, 53.22450, 65.07300, 5…
$ hs_ln_cat_h_None             &lt;fct&gt; 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2,…
$ hs_lden_cat_s_None           &lt;fct&gt; 1, 1, 1, 1, 4, 2, 1, 3, 3, 1, 1, 3, 4, 1,…
$ hs_dde_cadj_Log2             &lt;dbl&gt; 6.931470, 4.603694, 5.959344, 4.491256, 3…
$ hs_dde_madj_Log2             &lt;dbl&gt; 4.638426, 3.503177, 10.893742, 6.232923, …
$ hs_ddt_cadj_Log2             &lt;dbl&gt; 0.2970882, 0.7680593, 1.4533812, 1.525552…
$ hs_ddt_madj_Log2             &lt;dbl&gt; 0.2577006, 0.2577006, 6.5565927, 1.964627…
$ hs_hcb_cadj_Log2             &lt;dbl&gt; 3.928449, 3.769760, 4.818599, 3.300304, 2…
$ hs_hcb_madj_Log2             &lt;dbl&gt; 1.824003, 2.564390, 2.592053, 3.325764, 2…
$ hs_pcb118_cadj_Log2          &lt;dbl&gt; 1.2977475, 1.2748129, 1.6622520, 1.371607…
$ hs_pcb118_madj_Log2          &lt;dbl&gt; 1.0521823, 0.6562714, 1.1287777, 2.978092…
$ hs_pcb138_cadj_Log2          &lt;dbl&gt; 2.3525572, 2.3322423, 2.6611151, 3.784582…
$ hs_pcb138_madj_Log2          &lt;dbl&gt; 2.4940391, 2.4940391, 1.7636204, 4.992548…
$ hs_pcb153_cadj_Log2          &lt;dbl&gt; 3.248377, 3.821372, 3.945067, 4.749490, 2…
$ hs_pcb153_madj_Log2          &lt;dbl&gt; 2.852110, 2.582639, 2.852110, 5.831959, 3…
$ hs_pcb170_cadj_Log2          &lt;dbl&gt; 0.08207138, -0.52036182, 0.65733132, 1.02…
$ hs_pcb170_madj_Log2          &lt;dbl&gt; -1.2372802, -1.2372802, -0.3211039, 3.896…
$ hs_pcb180_cadj_Log2          &lt;dbl&gt; 1.4080790, 0.6983198, 2.2941031, 3.340395…
$ hs_pcb180_madj_Log2          &lt;dbl&gt; 2.4272315, 2.4272315, 1.3746028, 5.211053…
$ hs_sumPCBs5_cadj_Log2        &lt;dbl&gt; 4.377198, 4.537206, 5.059411, 5.919856, 3…
$ hs_sumPCBs5_madj_Log2        &lt;dbl&gt; 3.203309, 4.007477, 4.152160, 7.211848, 3…
$ hs_dep_cadj_Log2             &lt;dbl&gt; 1.74476672, 0.27498549, -0.27461127, -10.…
$ hs_dep_madj_Log2             &lt;dbl&gt; 3.0912536, 1.5457521, 1.5457521, 5.080127…
$ hs_detp_cadj_Log2            &lt;dbl&gt; 2.6944684, -6.8184598, -0.5384437, -6.311…
$ hs_detp_madj_Log2            &lt;dbl&gt; 3.2161570, 1.0078850, 1.0078850, -3.69631…
$ hs_dmdtp_cdich_None          &lt;fct&gt; Undetected, Undetected, Detected, Undetec…
$ hs_dmp_cadj_Log2             &lt;dbl&gt; -4.0318622, -6.4363044, -8.9539158, -5.08…
$ hs_dmp_madj_Log2             &lt;dbl&gt; 2.9433574, 2.1942911, 2.9433574, 3.293906…
$ hs_dmtp_cadj_Log2            &lt;dbl&gt; 0.8459927, 1.9233638, 3.0682471, -5.10521…
$ hs_dmtp_madj_Log2            &lt;dbl&gt; 4.10736093, 1.20021121, 4.10736093, 3.576…
$ hs_pbde153_cadj_Log2         &lt;dbl&gt; -7.8475381, -1.2116525, -7.2844585, -9.32…
$ hs_pbde153_madj_Log2         &lt;dbl&gt; -0.03209840, -0.72344958, -0.72344958, -1…
$ hs_pbde47_cadj_Log2          &lt;dbl&gt; -8.9728400, -2.4243205, -2.5066911, -3.44…
$ hs_pbde47_madj_Log2          &lt;dbl&gt; -1.4042180, -0.2313590, -1.8333971, -0.43…
$ hs_pfhxs_c_Log2              &lt;dbl&gt; -2.73320634, -3.48387601, -2.24840988, 1.…
$ hs_pfhxs_m_Log2              &lt;dbl&gt; -0.687707983, -1.549184532, -1.082757875,…
$ hs_pfna_c_Log2               &lt;dbl&gt; -2.48372269, -0.97229214, -0.10643005, -0…
$ hs_pfna_m_Log2               &lt;dbl&gt; -1.1584929, -0.9823236, -0.1497498, 0.362…
$ hs_pfoa_c_Log2               &lt;dbl&gt; -0.05315422, 0.62745590, 0.83831144, 1.07…
$ hs_pfoa_m_Log2               &lt;dbl&gt; -0.3632912, -2.2728850, 0.4106915, 2.2795…
$ hs_pfos_c_Log2               &lt;dbl&gt; -0.38337839, -0.04316422, 0.55768510, 3.0…
$ hs_pfos_m_Log2               &lt;dbl&gt; 0.2179881, 2.1738486, 2.3952115, 4.019819…
$ hs_pfunda_c_Log2             &lt;dbl&gt; -4.000194, -5.178933, -5.577692, -2.24362…
$ hs_pfunda_m_Log2             &lt;dbl&gt; -3.2250079, -2.4030518, -0.7264510, -2.91…
$ hs_bpa_cadj_Log2             &lt;dbl&gt; 2.4772244, 2.3889213, 2.1961708, 2.244282…
$ hs_bpa_madj_Log2             &lt;dbl&gt; 0.05551944, 0.29199592, 1.06476036, 2.094…
$ hs_bupa_cadj_Log2            &lt;dbl&gt; -1.9910343, -1.9327542, -3.9561076, -5.73…
$ hs_bupa_madj_Log2            &lt;dbl&gt; 1.7825148, 1.7825148, -2.2540446, -1.7875…
$ hs_etpa_cadj_Log2            &lt;dbl&gt; 0.25162413, 0.52518659, -1.46796280, -0.7…
$ hs_etpa_madj_Log2            &lt;dbl&gt; 5.79901555, 3.28026401, 5.37589705, -1.32…
$ hs_mepa_cadj_Log2            &lt;dbl&gt; 3.3022934, 1.8018050, 2.5656644, 6.542008…
$ hs_mepa_madj_Log2            &lt;dbl&gt; 8.1331356, 9.2005475, 8.1331356, 1.785878…
$ hs_oxbe_cadj_Log2            &lt;dbl&gt; -0.30053896, -1.55772770, -0.43999936, -2…
$ hs_oxbe_madj_Log2            &lt;dbl&gt; 6.7364323, 0.6546953, 1.8318678, 2.754110…
$ hs_prpa_cadj_Log2            &lt;dbl&gt; -4.92777202, -0.01703175, -5.70004580, -1…
$ hs_prpa_madj_Log2            &lt;dbl&gt; 7.0527639, 6.3297033, 6.7250904, 2.941532…
$ hs_trcs_cadj_Log2            &lt;dbl&gt; -0.265468775, -1.860420545, -1.400197798,…
$ hs_trcs_madj_Log2            &lt;dbl&gt; 8.01825911, -0.17483361, -0.17483361, 4.6…
$ hs_mbzp_cadj_Log2            &lt;dbl&gt; 3.3532699, 5.6637287, 3.3272966, 0.695401…
$ hs_mbzp_madj_Log2            &lt;dbl&gt; 3.24276315, 1.86067981, 4.77905012, 3.034…
$ hs_mecpp_cadj_Log2           &lt;dbl&gt; 6.815175, 4.950059, 5.009923, 4.338707, 5…
$ hs_mecpp_madj_Log2           &lt;dbl&gt; 5.874621, 4.741951, 4.850658, 6.346643, 5…
$ hs_mehhp_cadj_Log2           &lt;dbl&gt; 5.043494, 4.857453, 4.227012, 2.879596, 4…
$ hs_mehhp_madj_Log2           &lt;dbl&gt; 4.012001, 4.391042, 4.067675, 5.608232, 3…
$ hs_mehp_cadj_Log2            &lt;dbl&gt; 1.0129893, 1.6884226, 1.0204371, 0.486090…
$ hs_mehp_madj_Log2            &lt;dbl&gt; 3.5077481, 1.7013323, 1.7469755, 2.453339…
$ hs_meohp_cadj_Log2           &lt;dbl&gt; 4.992377, 4.549745, 3.473975, 2.653729, 3…
$ hs_meohp_madj_Log2           &lt;dbl&gt; 3.649581, 4.360200, 3.532362, 4.700827, 2…
$ hs_mep_cadj_Log2             &lt;dbl&gt; 4.168832, 6.025384, 3.861531, 3.575644, 8…
$ hs_mep_madj_Log2             &lt;dbl&gt; 7.123924, 8.910995, 8.400838, 5.821934, 1…
$ hs_mibp_cadj_Log2            &lt;dbl&gt; 6.782071, 6.195669, 6.154459, 5.426139, 5…
$ hs_mibp_madj_Log2            &lt;dbl&gt; 4.433047, 6.083043, 4.976039, 5.626695, 4…
$ hs_mnbp_cadj_Log2            &lt;dbl&gt; 6.960653, 5.755960, 4.464226, 5.616907, 5…
$ hs_mnbp_madj_Log2            &lt;dbl&gt; 4.788463, 3.839804, 4.788463, 4.842579, 4…
$ hs_ohminp_cadj_Log2          &lt;dbl&gt; 3.8445765, 2.0643701, 2.6980526, 1.075322…
$ hs_ohminp_madj_Log2          &lt;dbl&gt; 0.02350192, -0.90016327, -0.56501743, 0.6…
$ hs_oxominp_cadj_Log2         &lt;dbl&gt; 2.08084891, 0.49145227, 1.39715783, 1.535…
$ hs_oxominp_madj_Log2         &lt;dbl&gt; -0.6964288, -0.6939739, -0.6964288, 3.774…
$ hs_sumDEHP_cadj_Log2         &lt;dbl&gt; 5.923815, 7.401802, 5.810282, 5.358708, 6…
$ hs_sumDEHP_madj_Log2         &lt;dbl&gt; 5.805357, 5.805357, 5.774054, 7.227603, 4…
$ FAS_cat_None                 &lt;fct&gt; Middle, Middle, Middle, High, Low, Middle…
$ hs_contactfam_3cat_num_None  &lt;fct&gt; Once a week, (almost) Daily, Once a week,…
$ hs_hm_pers_None              &lt;dbl&gt; 3, 4, 4, 3, 4, 4, 4, 3, 4, 5, 5, 4, 3, 4,…
$ hs_participation_3cat_None   &lt;fct&gt; 1 organisation, 1 organisation, None, Non…
$ e3_asmokcigd_p_None          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ hs_cotinine_cdich_None       &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ hs_cotinine_mcat_None        &lt;fct&gt; Smokers, Smokers, Smokers, Non-smokers, N…
$ hs_globalexp2_None           &lt;fct&gt; exposure, no exposure, no exposure, expos…
$ hs_smk_parents_None          &lt;fct&gt; both, neither, one, one, neither, neither…
$ h_distinvnear1_preg_Log      &lt;dbl&gt; -5.629052, -5.045588, -4.204225, -3.08801…
$ h_trafload_preg_pow1over3    &lt;dbl&gt; 0.3458301, 0.3458301, 145.5727586, 187.12…
$ h_trafnear_preg_pow1over3    &lt;dbl&gt; 21.213987, 22.649684, 25.549436, 22.74385…
$ hs_trafload_h_pow1over3      &lt;dbl&gt; 135.99576, 97.88442, 127.53614, 114.86848…
$ hs_trafnear_h_pow1over3      &lt;dbl&gt; 24.914911, 27.905292, 29.299706, 22.74385…
$ h_bro_preg_Log               &lt;dbl&gt; -2.9759296, -2.9759296, -1.6044503, 2.748…
$ h_clf_preg_Log               &lt;dbl&gt; -0.5367134, 1.0787497, 1.1887577, 3.63681…
$ h_thm_preg_Log               &lt;dbl&gt; 0.2880726, 3.1954784, 3.0239239, 3.839335…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(covariates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,301
Columns: 14
$ ID                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…
$ h_cohort          &lt;fct&gt; 4, 4, 4, 2, 3, 1, 2, 1, 2, 1, 1, 3, 2, 2, 4, 4, 4, 4…
$ e3_sex_None       &lt;fct&gt; male, male, male, female, male, female, male, female…
$ e3_yearbir_None   &lt;fct&gt; 2008, 2007, 2008, 2005, 2005, 2007, 2003, 2008, 2004…
$ h_mbmi_None       &lt;dbl&gt; 25.51020, 26.49151, 30.11621, 21.04805, 22.15102, 24…
$ hs_wgtgain_None   &lt;dbl&gt; 17, 18, 11, 21, 20, 30, 20, 20, 12, 9, 10, 18, 5, 20…
$ e3_gac_None       &lt;dbl&gt; 41.00000, 41.00000, 39.00000, 39.28571, 43.00000, 38…
$ h_age_None        &lt;dbl&gt; 28.00000, 22.84155, 34.23242, 32.72553, 20.86516, 27…
$ h_edumc_None      &lt;fct&gt; 2, 3, 3, 1, 1, 3, 1, 2, 2, 1, 3, 3, 3, 2, 2, 3, 3, 2…
$ h_native_None     &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 0, 2, 1, 0, 2, 2, 2, 2, 2, 2, 2…
$ h_parity_None     &lt;fct&gt; 0, 1, 1, 1, 0, 0, 2, 0, 1, 2, 1, 1, 1, 0, 0, 2, 1, 1…
$ hs_child_age_None &lt;dbl&gt; 6.165640, 6.992471, 6.110883, 10.138261, 9.451175, 6…
$ hs_c_height_None  &lt;dbl&gt; 1.220, 1.220, 1.280, 1.345, 1.370, 1.130, 1.315, 1.2…
$ hs_c_weight_None  &lt;dbl&gt; 23.4, 27.6, 37.5, 27.7, 34.0, 21.5, 29.8, 22.5, 24.3…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(codebook)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 241
Columns: 12
$ variable_name    &lt;fct&gt; h_abs_ratio_preg_Log, h_no2_ratio_preg_Log, h_pm10_ra…
$ domain           &lt;fct&gt; Outdoor exposures, Outdoor exposures, Outdoor exposur…
$ family           &lt;fct&gt; Air Pollution, Air Pollution, Air Pollution, Air Poll…
$ subfamily        &lt;fct&gt; PMAbsorbance, NO2, PM10, PM2.5, NO2, NO2, NO2, PM10, …
$ period           &lt;fct&gt; Pregnancy, Pregnancy, Pregnancy, Pregnancy, Postnatal…
$ location         &lt;fct&gt; Home, Home, Home, Home, Home, Home, Home, Home, Home,…
$ period_postnatal &lt;fct&gt; NA, NA, NA, NA, Day before examination, Week before e…
$ description      &lt;fct&gt; "abs value (extrapolated back in time using ratio met…
$ var_type         &lt;fct&gt; numeric, numeric, numeric, numeric, numeric, numeric,…
$ transformation   &lt;fct&gt; Natural Logarithm, Natural Logarithm, None, None, Nat…
$ labels           &lt;fct&gt; PMabs, NO2, PM10, PM2.5, NO2(day), NO2(week), NO2(yea…
$ labelsshort      &lt;fct&gt; PMabs, NO2, PM10, PM2.5, NO2(day), NO2(week), NO2(yea…</code></pre>
</div>
</div>
<p>We are going to use the <code>rexposome::loadExposome</code> function to create a single dataset (<code>ExposomeSet</code>) through the <code>data.frames</code> that we initially loaded. First we will organize the data in the appropriate format for our analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Time windows of exposure availables for the analysis</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(codebook<span class="sc">$</span>period)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Postnatal" "Pregnancy"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exposure families availables for the analysis</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(codebook<span class="sc">$</span>family)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Air Pollution"                             
 [2] "Built environment"                         
 [3] "Covariates"                                
 [4] "Indoor air"                                
 [5] "Lifestyle"                                 
 [6] "Metals"                                    
 [7] "Meteorological"                            
 [8] "Natural Spaces"                            
 [9] "Noise"                                     
[10] "Organochlorines"                           
[11] "Organophosphate pesticides"                
[12] "Per- and polyfluoroalkyl substances (PFAS)"
[13] "Phenols"                                   
[14] "Phenotype"                                 
[15] "Phthalates"                                
[16] "Polybrominated diphenyl ethers (PBDE)"     
[17] "Social and economic capital"               
[18] "Tobacco Smoke"                             
[19] "Traffic"                                   
[20] "Water DBPs"                                </code></pre>
</div>
</div>
<ul>
<li>Processing data for the Exposome analysis</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> <span class="fu">as.character</span>(codebook<span class="sc">$</span>variable_name[(codebook<span class="sc">$</span>family <span class="sc">==</span> <span class="st">"Organochlorines"</span> <span class="sc">|</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                                                  codebook<span class="sc">$</span>family <span class="sc">==</span> <span class="st">"Metals"</span>) <span class="sc">&amp;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                                                  codebook<span class="sc">$</span>period <span class="sc">==</span> <span class="st">"Postnatal"</span>]) <span class="co"># we can also select "Pregnancy" period</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>expo.list</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "hs_as_c_Log2"          "hs_cd_c_Log2"          "hs_co_c_Log2"         
 [4] "hs_cs_c_Log2"          "hs_cu_c_Log2"          "hs_hg_c_Log2"         
 [7] "hs_mn_c_Log2"          "hs_mo_c_Log2"          "hs_pb_c_Log2"         
[10] "hs_tl_cdich_None"      "hs_dde_cadj_Log2"      "hs_ddt_cadj_Log2"     
[13] "hs_hcb_cadj_Log2"      "hs_pcb118_cadj_Log2"   "hs_pcb138_cadj_Log2"  
[16] "hs_pcb153_cadj_Log2"   "hs_pcb170_cadj_Log2"   "hs_pcb180_cadj_Log2"  
[19] "hs_sumPCBs5_cadj_Log2"</code></pre>
</div>
</div>
<p>We can exclude unnecessary information</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> expo.list[<span class="sc">-</span><span class="fu">which</span>(expo.list <span class="sc">==</span> <span class="st">"hs_tl_cdich_None"</span>)]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> expo.list[<span class="sc">-</span><span class="fu">which</span>(expo.list <span class="sc">==</span> <span class="st">"hs_sumPCBs5_cadj_Log2"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Select specific columns (variables) from the families that we selected in the previous step and add the identifier per subject (ID)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>expo2 <span class="ot">&lt;-</span> exposome[ ,<span class="fu">c</span>(<span class="st">"ID"</span>, expo.list)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we scale the continuous variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>index.cont <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>,<span class="dv">11</span><span class="sc">:</span><span class="fu">ncol</span>(expo2))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> index.cont) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  expo2[,i] <span class="ot">&lt;-</span> expo2[,i]<span class="sc">/</span><span class="fu">IQR</span>(expo2[,i],<span class="at">na.rm=</span>T)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>codebook[expo.list,]<span class="sc">$</span>labels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] As      Cd      Co      Cs      Cu      Hg      Mn      Mo      Pb     
[10] DDE     DDT     HCB     PCB 118 PCB 138 PCB 153 PCB 170 PCB 180
178 Levels: Access_ lines Access_ lines_home ... Yogurt</code></pre>
</div>
</div>
<ul>
<li>We combine data from the <code>phenotype</code> and <code>covariates</code> files</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">hs_zbmi_who =</span> phenotype[ ,<span class="dv">4</span>],  <span class="co"># we select the 4th column of the phenotype dataframe and call it hs_zbmi_who</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>             covariates[ ,<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>])  <span class="co"># we select from columns 2 to 13 of the covariates dataframe</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(expo2, dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,301
Columns: 31
$ ID                  &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15,…
$ hs_as_c_Log2        &lt;dbl&gt; -4.28280856, -6.43028014, -7.97829150, 0.63226822,…
$ hs_cd_c_Log2        &lt;dbl&gt; -4.115508, -4.228603, -4.027235, -5.227292, -3.729…
$ hs_co_c_Log2        &lt;dbl&gt; 1.509089, -3.866323, -3.776703, -4.432068, -2.3824…
$ hs_cs_c_Log2        &lt;dbl&gt; 0.3342716, 0.2685689, 0.5188887, 0.8911191, 1.2028…
$ hs_cu_c_Log2        &lt;dbl&gt; 34.12738, 34.94684, 34.89511, 35.81951, 33.16411, …
$ hs_hg_c_Log2        &lt;dbl&gt; -1.049020025, -0.633919339, -0.443835176, 0.721573…
$ hs_mn_c_Log2        &lt;dbl&gt; 6.217601, 5.179186, 5.388626, 5.779506, 5.175665, …
$ hs_mo_c_Log2        &lt;dbl&gt; 1.2010916, 1.3552967, -0.6128079, -7.4270093, -0.3…
$ hs_pb_c_Log2        &lt;dbl&gt; 3.632268, 3.405992, 2.815575, 3.168321, 3.632268, …
$ hs_dde_cadj_Log2    &lt;dbl&gt; 3.561138, 2.365211, 3.061695, 2.307444, 1.988201, …
$ hs_ddt_cadj_Log2    &lt;dbl&gt; 0.11790564, 0.30482029, 0.57680451, 0.60544700, -0…
$ hs_hcb_cadj_Log2    &lt;dbl&gt; 4.515501, 4.333098, 5.538670, 3.793488, 2.450592, …
$ hs_pcb118_cadj_Log2 &lt;dbl&gt; 1.3577957, 1.3337999, 1.7391663, 1.4350737, 0.1500…
$ hs_pcb138_cadj_Log2 &lt;dbl&gt; 1.7223584, 1.7074854, 1.9482603, 2.7707752, 1.2092…
$ hs_pcb153_cadj_Log2 &lt;dbl&gt; 2.388171, 2.809431, 2.900370, 3.491772, 1.930957, …
$ hs_pcb170_cadj_Log2 &lt;dbl&gt; 0.03664436, -0.23233831, 0.29349434, 0.45647345, -…
$ hs_pcb180_cadj_Log2 &lt;dbl&gt; 0.60971664, 0.30238160, 0.99337671, 1.44643501, 0.…
$ hs_zbmi_who         &lt;dbl&gt; 0.30, 0.41, 3.33, -0.76, 0.98, -0.08, 0.04, -0.10,…
$ h_cohort            &lt;fct&gt; 4, 4, 4, 2, 3, 1, 2, 1, 2, 1, 1, 3, 2, 2, 4, 4, 4,…
$ e3_sex_None         &lt;fct&gt; male, male, male, female, male, female, male, fema…
$ e3_yearbir_None     &lt;fct&gt; 2008, 2007, 2008, 2005, 2005, 2007, 2003, 2008, 20…
$ h_mbmi_None         &lt;dbl&gt; 25.51020, 26.49151, 30.11621, 21.04805, 22.15102, …
$ hs_wgtgain_None     &lt;dbl&gt; 17, 18, 11, 21, 20, 30, 20, 20, 12, 9, 10, 18, 5, …
$ e3_gac_None         &lt;dbl&gt; 41.00000, 41.00000, 39.00000, 39.28571, 43.00000, …
$ h_age_None          &lt;dbl&gt; 28.00000, 22.84155, 34.23242, 32.72553, 20.86516, …
$ h_edumc_None        &lt;fct&gt; 2, 3, 3, 1, 1, 3, 1, 2, 2, 1, 3, 3, 3, 2, 2, 3, 3,…
$ h_native_None       &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 0, 2, 1, 0, 2, 2, 2, 2, 2, 2,…
$ h_parity_None       &lt;fct&gt; 0, 1, 1, 1, 0, 0, 2, 0, 1, 2, 1, 1, 1, 0, 0, 2, 1,…
$ hs_child_age_None   &lt;dbl&gt; 6.165640, 6.992471, 6.110883, 10.138261, 9.451175,…
$ hs_c_height_None    &lt;dbl&gt; 1.220, 1.220, 1.280, 1.345, 1.370, 1.130, 1.315, 1…</code></pre>
</div>
</div>
<p>Now we will create our <code>ExposomeSet</code> object by combining our three files that we worked on in the previous lines. We need to create this specific object to use some of the functionalities of the <code>rexposome</code> package.</p>
<p>This dataset is composed of:</p>
<ul>
<li><strong>3 families of exposures</strong> (built environment, metals, organochlorines), there are <strong>32 exposures in total</strong>. (continuous variables)</li>
<li><strong>1 outcome</strong> (z-score for BMI) (continuous variable)</li>
<li><strong>1 exposure window</strong> (postnatal period)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> rexposome<span class="sc">::</span><span class="fu">loadExposome</span>(<span class="at">exposures =</span> expo2[expo.list],</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">description =</span> codebook[expo.list,],</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">phenotype =</span> dat,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">description.famCol =</span> <span class="st">"family"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in check_dep_version(): ABI version mismatch: 
lme4 was built with Matrix ABI version 1
Current Matrix ABI version is 0
Please re-install lme4 from source or restore original 'Matrix' package</code></pre>
</div>
</div>
<p>We will also create a dataset (containing the same data) but joining the <code>phenotype</code>, <code>exposome</code>, <code>covariates</code> files. This dataframe will be more easy to handle it outside the functionalities of <code>rexposome</code> package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>exp_all <span class="ot">&lt;-</span> phenotype <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">inner_join</span>(exposome, <span class="at">by =</span> <span class="st">"ID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>           dplyr<span class="sc">::</span><span class="fu">inner_join</span>(covariates, <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(exp_all)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,301
Columns: 242
$ ID                           &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13…
$ e3_bw                        &lt;int&gt; 4100, 4158, 4110, 3270, 3950, 2900, 3350,…
$ hs_asthma                    &lt;dbl&gt; 0, 0, 1, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0,…
$ hs_zbmi_who                  &lt;dbl&gt; 0.30, 0.41, 3.33, -0.76, 0.98, -0.08, 0.0…
$ hs_correct_raven             &lt;int&gt; 18, 25, 13, 28, 19, 19, 34, 16, 35, 32, 1…
$ hs_Gen_Tot                   &lt;dbl&gt; 84.0000, 39.0000, 40.0000, 54.5000, 18.00…
$ hs_bmi_c_cat                 &lt;fct&gt; 2, 2, 4, 2, 2, 2, 2, 2, 2, 3, 4, 4, 2, 2,…
$ h_abs_ratio_preg_Log         &lt;dbl&gt; 0.89671105, 0.89253797, 0.77872299, 0.089…
$ h_no2_ratio_preg_Log         &lt;dbl&gt; 2.872304, 2.980008, 3.056501, 3.089157, 3…
$ h_pm10_ratio_preg_None       &lt;dbl&gt; 25.94850, 25.89774, 26.08735, 14.99138, 3…
$ h_pm25_ratio_preg_None       &lt;dbl&gt; 17.433798, 18.470850, 18.711547, 16.40977…
$ hs_no2_dy_hs_h_Log           &lt;dbl&gt; 2.530279, 1.928600, 2.882591, 1.390750, 3…
$ hs_no2_wk_hs_h_Log           &lt;dbl&gt; 2.583284, 2.652479, 2.591756, 2.456717, 3…
$ hs_no2_yr_hs_h_Log           &lt;dbl&gt; 2.612098, 2.761064, 2.356163, 2.403247, 3…
$ hs_pm10_dy_hs_h_None         &lt;dbl&gt; 22.53583, 14.07776, 46.85910, 29.81744, 2…
$ hs_pm10_wk_hs_h_None         &lt;dbl&gt; 20.850005, 29.141274, 31.530981, 25.23277…
$ hs_pm10_yr_hs_h_None         &lt;dbl&gt; 31.39907, 31.25053, 27.51600, 23.96526, 2…
$ hs_pm25_dy_hs_h_None         &lt;dbl&gt; 16.950474, 11.155481, 28.454911, 4.624601…
$ hs_pm25_wk_hs_h_None         &lt;dbl&gt; 17.001157, 15.910697, 21.274005, 10.96794…
$ hs_pm25_yr_hs_h_None         &lt;dbl&gt; 18.395672, 17.735640, 16.808644, 12.72905…
$ hs_pm25abs_dy_hs_h_Log       &lt;dbl&gt; 0.09739716, -0.43039392, 0.91559425, -0.2…
$ hs_pm25abs_wk_hs_h_Log       &lt;dbl&gt; 0.07115366, 0.21428919, 0.71974438, -0.13…
$ hs_pm25abs_yr_hs_h_Log       &lt;dbl&gt; 0.32106365, 0.28149354, 0.09872019, 0.177…
$ h_accesslines300_preg_dic0   &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ h_accesspoints300_preg_Log   &lt;dbl&gt; 1.962937, 2.368356, 1.269931, 4.527757, 3…
$ h_builtdens300_preg_Sqrt     &lt;dbl&gt; 405.12310, 310.82760, 374.61057, 565.0784…
$ h_connind300_preg_Sqrt       &lt;dbl&gt; 1.886691, 6.535691, 6.257448, 14.491952, …
$ h_fdensity300_preg_Log       &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 13.84635, 1…
$ h_frichness300_preg_None     &lt;dbl&gt; 0.00000000, 0.00000000, 0.00000000, 0.245…
$ h_landuseshan300_preg_None   &lt;dbl&gt; 0.3638871, 0.4007151, 0.2881437, 0.632757…
$ h_popdens_preg_Sqrt          &lt;dbl&gt; 84.988234, 84.988234, 84.988234, 66.53570…
$ h_walkability_mean_preg_None &lt;dbl&gt; 0.175, 0.200, 0.150, 0.350, 0.275, 0.350,…
$ hs_accesslines300_h_dic0     &lt;dbl&gt; 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ hs_accesspoints300_h_Log     &lt;dbl&gt; 1.6753021, 2.7737896, 0.5770643, 4.583846…
$ hs_builtdens300_h_Sqrt       &lt;dbl&gt; 406.51919, 382.52734, 374.66924, 479.9022…
$ hs_connind300_h_Log          &lt;dbl&gt; 4.565486, 3.754556, 2.879087, 5.474342, 4…
$ hs_fdensity300_h_Log         &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 13.97641, 1…
$ hs_landuseshan300_h_None     &lt;dbl&gt; 0.3535060, 0.3205542, 0.4792989, 0.454445…
$ hs_popdens_h_Sqrt            &lt;dbl&gt; 84.988234, 10.246951, 10.246951, 66.53570…
$ hs_walkability_mean_h_None   &lt;dbl&gt; 0.375, 0.200, 0.250, 0.525, 0.300, 0.375,…
$ hs_accesslines300_s_dic0     &lt;dbl&gt; 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0,…
$ hs_accesspoints300_s_Log     &lt;dbl&gt; 0.5770643, 2.1860528, 2.1860528, 3.284590…
$ hs_builtdens300_s_Sqrt       &lt;dbl&gt; 384.99302, 383.64898, 366.41259, 406.2726…
$ hs_connind300_s_Log          &lt;dbl&gt; 2.368262, 3.466874, 3.977700, 5.651676, 4…
$ hs_fdensity300_s_Log         &lt;dbl&gt; 10.26284, 10.26284, 10.26284, 12.34228, 1…
$ hs_landuseshan300_s_None     &lt;dbl&gt; 0.2800504, 0.3682542, 0.3252277, 0.520970…
$ hs_popdens_s_Sqrt            &lt;dbl&gt; 84.988234, 84.988234, 84.988234, 25.71451…
$ h_Absorbance_Log             &lt;dbl&gt; -0.135119353, -0.057699576, -0.437228805,…
$ h_Benzene_Log                &lt;dbl&gt; 0.57215704, 0.87975097, 1.37913427, 1.168…
$ h_NO2_Log                    &lt;dbl&gt; 4.576481, 3.368754, 4.297368, 2.504501, 6…
$ h_PM_Log                     &lt;dbl&gt; 2.604548, 2.328879, 2.327120, 1.657071, 3…
$ h_TEX_Log                    &lt;dbl&gt; 2.529664, 2.841000, 2.884071, 2.668584, 3…
$ e3_alcpreg_yn_None           &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1,…
$ h_bfdur_Ter                  &lt;fct&gt; "(0,10.8]", "(0,10.8]", "(34.9,Inf]", "(1…
$ h_cereal_preg_Ter            &lt;fct&gt; "(0,9]", "(0,9]", "(9,27.3]", "(27.3,Inf]…
$ h_dairy_preg_Ter             &lt;fct&gt; "(27.1,Inf]", "(27.1,Inf]", "(27.1,Inf]",…
$ h_fastfood_preg_Ter          &lt;fct&gt; "(0.25,0.83]", "(0.83,Inf]", "(0.83,Inf]"…
$ h_fish_preg_Ter              &lt;fct&gt; "(4.1,Inf]", "(4.1,Inf]", "(4.1,Inf]", "(…
$ h_folic_t1_None              &lt;fct&gt; 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,…
$ h_fruit_preg_Ter             &lt;fct&gt; "(0.6,18.2]", "(0.6,18.2]", "(0.6,18.2]",…
$ h_legume_preg_Ter            &lt;fct&gt; "(2,Inf]", "(2,Inf]", "(2,Inf]", "(2,Inf]…
$ h_meat_preg_Ter              &lt;fct&gt; "(6.5,10]", "(10,Inf]", "(6.5,10]", "(10,…
$ h_pamod_t3_None              &lt;fct&gt; Very Often, None, Often, Often, Very Ofte…
$ h_pavig_t3_None              &lt;fct&gt; Low, Low, Low, Medium, Medium, Medium, Lo…
$ h_veg_preg_Ter               &lt;fct&gt; "(8.8,16.5]", "(8.8,16.5]", "(8.8,16.5]",…
$ hs_bakery_prod_Ter           &lt;fct&gt; "(2,6]", "(0,2]", "(2,6]", "(6,Inf]", "(2…
$ hs_beverages_Ter             &lt;fct&gt; "(1,Inf]", "(0.132,1]", "(0.132,1]", "(0,…
$ hs_break_cer_Ter             &lt;fct&gt; "(0,1.1]", "(0,1.1]", "(1.1,5.5]", "(5.5,…
$ hs_caff_drink_Ter            &lt;fct&gt; "(0,0.132]", "(0.132,Inf]", "(0.132,Inf]"…
$ hs_dairy_Ter                 &lt;fct&gt; "(0,14.6]", "(0,14.6]", "(0,14.6]", "(25.…
$ hs_fastfood_Ter              &lt;fct&gt; "(0.132,0.5]", "(0.132,0.5]", "(0.132,0.5…
$ hs_KIDMED_None               &lt;dbl&gt; 2, 0, 1, 2, 4, 5, 2, 3, 3, 3, 3, 8, 2, 1,…
$ hs_mvpa_prd_alt_None         &lt;dbl&gt; 47.892043, 31.831901, 117.576830, -2.0334…
$ hs_org_food_Ter              &lt;fct&gt; "(0.132,1]", "(1,Inf]", "(0.132,1]", "(0.…
$ hs_pet_cat_r2_None           &lt;fct&gt; 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0,…
$ hs_pet_dog_r2_None           &lt;fct&gt; 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0,…
$ hs_pet_None                  &lt;fct&gt; Yes, No, No, Yes, Yes, Yes, Yes, No, Yes,…
$ hs_proc_meat_Ter             &lt;fct&gt; "(1.5,4]", "(1.5,4]", "(4,Inf]", "(0,1.5]…
$ hs_readymade_Ter             &lt;fct&gt; "(0,0.132]", "(0.5,Inf]", "(0.5,Inf]", "(…
$ hs_sd_wk_None                &lt;dbl&gt; 388.57143, 522.85714, 445.71429, 180.0000…
$ hs_total_bread_Ter           &lt;fct&gt; "(0,7]", "(17.5,Inf]", "(0,7]", "(17.5,In…
$ hs_total_cereal_Ter          &lt;fct&gt; "(0,14.1]", "(14.1,23.6]", "(14.1,23.6]",…
$ hs_total_fish_Ter            &lt;fct&gt; "(0,1.5]", "(0,1.5]", "(0,1.5]", "(1.5,3]…
$ hs_total_fruits_Ter          &lt;fct&gt; "(14.1,Inf]", "(0,7]", "(0,7]", "(14.1,In…
$ hs_total_lipids_Ter          &lt;fct&gt; "(7,Inf]", "(7,Inf]", "(7,Inf]", "(3,7]",…
$ hs_total_meat_Ter            &lt;fct&gt; "(6,9]", "(0,6]", "(9,Inf]", "(0,6]", "(6…
$ hs_total_potatoes_Ter        &lt;fct&gt; "(4,Inf]", "(3,4]", "(3,4]", "(0,3]", "(0…
$ hs_total_sweets_Ter          &lt;fct&gt; "(0,4.1]", "(8.5,Inf]", "(8.5,Inf]", "(8.…
$ hs_total_veg_Ter             &lt;fct&gt; "(8.5,Inf]", "(6,8.5]", "(8.5,Inf]", "(8.…
$ hs_total_yog_Ter             &lt;fct&gt; "(0,6]", "(0,6]", "(0,6]", "(8.5,Inf]", "…
$ hs_dif_hours_total_None      &lt;dbl&gt; 9.461109, 9.596343, 9.970835, 10.085262, …
$ hs_as_c_Log2                 &lt;dbl&gt; -4.28280856, -6.43028014, -7.97829150, 0.…
$ hs_as_m_Log2                 &lt;dbl&gt; -19.49712481, -9.58263737, -14.91793276, …
$ hs_cd_c_Log2                 &lt;dbl&gt; -4.140507, -4.254289, -4.051698, -5.25904…
$ hs_cd_m_Log2                 &lt;dbl&gt; -3.0709665, -2.5994621, -2.9657843, -0.93…
$ hs_co_c_Log2                 &lt;dbl&gt; 1.021480, -2.617056, -2.556393, -3.000000…
$ hs_co_m_Log2                 &lt;dbl&gt; -4.0831412, -2.4111954, -2.6259343, -2.80…
$ hs_cs_c_Log2                 &lt;dbl&gt; 0.2509616, 0.2016339, 0.3895668, 0.669026…
$ hs_cs_m_Log2                 &lt;dbl&gt; 0.1505597, -0.2722973, 0.5360529, 0.71369…
$ hs_cu_c_Log2                 &lt;dbl&gt; 9.710806, 9.943980, 9.929258, 10.192293, …
$ hs_cu_m_Log2                 &lt;dbl&gt; 10.216746, 10.511753, 10.264443, 10.09011…
$ hs_hg_c_Log2                 &lt;dbl&gt; -2.152003093, -1.300448367, -0.910501849,…
$ hs_hg_m_Log2                 &lt;dbl&gt; -3.12029423, -1.02326978, 0.08406426, 2.2…
$ hs_mn_c_Log2                 &lt;dbl&gt; 3.459432, 2.881665, 2.998196, 3.215679, 2…
$ hs_mn_m_Log2                 &lt;dbl&gt; 3.608809, 4.161888, 2.877744, 3.249445, 3…
$ hs_mo_c_Log2                 &lt;dbl&gt; 0.9486008, 1.0703893, -0.4839849, -5.8657…
$ hs_mo_m_Log2                 &lt;dbl&gt; -1.81096618, -2.41888982, -0.26534457, -0…
$ hs_pb_c_Log2                 &lt;dbl&gt; 3.632268, 3.405992, 2.815575, 3.168321, 3…
$ hs_pb_m_Log2                 &lt;dbl&gt; 2.604071, 3.817623, 3.158660, 2.575312, 3…
$ hs_tl_cdich_None             &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ hs_tl_mdich_None             &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ h_humidity_preg_None         &lt;dbl&gt; 89.91606, 82.19326, 86.88924, 77.91288, 7…
$ h_pressure_preg_None         &lt;dbl&gt; 981.4244, 982.8623, 980.8294, 1002.9952, …
$ h_temperature_preg_None      &lt;dbl&gt; 6.659455, 9.995885, 9.986814, 13.834848, …
$ hs_hum_mt_hs_h_None          &lt;dbl&gt; 79.29731, 85.55336, 81.89890, 81.72799, 5…
$ hs_tm_mt_hs_h_None           &lt;dbl&gt; 14.273439, 11.233588, 16.092377, 3.704591…
$ hs_uvdvf_mt_hs_h_None        &lt;dbl&gt; 0.13833333, 1.91900000, 1.66500000, 0.274…
$ hs_hum_dy_hs_h_None          &lt;dbl&gt; 54.44336, 70.39935, 77.63110, 47.68000, 5…
$ hs_hum_wk_hs_h_None          &lt;dbl&gt; 85.44951, 92.17720, 81.44176, 82.42149, 6…
$ hs_tm_dy_hs_h_None           &lt;dbl&gt; 17.1106000, 4.8696000, 16.8812000, 7.6062…
$ hs_tm_wk_hs_h_None           &lt;dbl&gt; 13.100794, 12.814309, 12.361921, 5.213848…
$ hs_uvdvf_dy_hs_h_None        &lt;dbl&gt; 2.60, 0.38, 1.59, 0.48, 2.89, 0.19, 0.44,…
$ hs_uvdvf_wk_hs_h_None        &lt;dbl&gt; 2.6871429, 0.4542857, 1.5828571, 0.437142…
$ hs_blueyn300_s_None          &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ h_blueyn300_preg_None        &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ h_greenyn300_preg_None       &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1,…
$ h_ndvi100_preg_None          &lt;dbl&gt; 0.4470029, 0.4812514, 0.4571000, 0.287485…
$ hs_greenyn300_s_None         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1,…
$ hs_blueyn300_h_None          &lt;fct&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ hs_greenyn300_h_None         &lt;fct&gt; 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1,…
$ hs_ndvi100_h_None            &lt;dbl&gt; 0.4653917, 0.5239703, 0.5486595, 0.361057…
$ hs_ndvi100_s_None            &lt;dbl&gt; 0.4712486, 0.5292686, 0.5351938, 0.383908…
$ h_lden_cat_preg_None         &lt;dbl&gt; 39.75385, 49.16870, 53.22450, 65.07300, 5…
$ hs_ln_cat_h_None             &lt;fct&gt; 2, 2, 1, 1, 1, 1, 1, 1, 2, 1, 1, 2, 2, 2,…
$ hs_lden_cat_s_None           &lt;fct&gt; 1, 1, 1, 1, 4, 2, 1, 3, 3, 1, 1, 3, 4, 1,…
$ hs_dde_cadj_Log2             &lt;dbl&gt; 6.931470, 4.603694, 5.959344, 4.491256, 3…
$ hs_dde_madj_Log2             &lt;dbl&gt; 4.638426, 3.503177, 10.893742, 6.232923, …
$ hs_ddt_cadj_Log2             &lt;dbl&gt; 0.2970882, 0.7680593, 1.4533812, 1.525552…
$ hs_ddt_madj_Log2             &lt;dbl&gt; 0.2577006, 0.2577006, 6.5565927, 1.964627…
$ hs_hcb_cadj_Log2             &lt;dbl&gt; 3.928449, 3.769760, 4.818599, 3.300304, 2…
$ hs_hcb_madj_Log2             &lt;dbl&gt; 1.824003, 2.564390, 2.592053, 3.325764, 2…
$ hs_pcb118_cadj_Log2          &lt;dbl&gt; 1.2977475, 1.2748129, 1.6622520, 1.371607…
$ hs_pcb118_madj_Log2          &lt;dbl&gt; 1.0521823, 0.6562714, 1.1287777, 2.978092…
$ hs_pcb138_cadj_Log2          &lt;dbl&gt; 2.3525572, 2.3322423, 2.6611151, 3.784582…
$ hs_pcb138_madj_Log2          &lt;dbl&gt; 2.4940391, 2.4940391, 1.7636204, 4.992548…
$ hs_pcb153_cadj_Log2          &lt;dbl&gt; 3.248377, 3.821372, 3.945067, 4.749490, 2…
$ hs_pcb153_madj_Log2          &lt;dbl&gt; 2.852110, 2.582639, 2.852110, 5.831959, 3…
$ hs_pcb170_cadj_Log2          &lt;dbl&gt; 0.08207138, -0.52036182, 0.65733132, 1.02…
$ hs_pcb170_madj_Log2          &lt;dbl&gt; -1.2372802, -1.2372802, -0.3211039, 3.896…
$ hs_pcb180_cadj_Log2          &lt;dbl&gt; 1.4080790, 0.6983198, 2.2941031, 3.340395…
$ hs_pcb180_madj_Log2          &lt;dbl&gt; 2.4272315, 2.4272315, 1.3746028, 5.211053…
$ hs_sumPCBs5_cadj_Log2        &lt;dbl&gt; 4.377198, 4.537206, 5.059411, 5.919856, 3…
$ hs_sumPCBs5_madj_Log2        &lt;dbl&gt; 3.203309, 4.007477, 4.152160, 7.211848, 3…
$ hs_dep_cadj_Log2             &lt;dbl&gt; 1.74476672, 0.27498549, -0.27461127, -10.…
$ hs_dep_madj_Log2             &lt;dbl&gt; 3.0912536, 1.5457521, 1.5457521, 5.080127…
$ hs_detp_cadj_Log2            &lt;dbl&gt; 2.6944684, -6.8184598, -0.5384437, -6.311…
$ hs_detp_madj_Log2            &lt;dbl&gt; 3.2161570, 1.0078850, 1.0078850, -3.69631…
$ hs_dmdtp_cdich_None          &lt;fct&gt; Undetected, Undetected, Detected, Undetec…
$ hs_dmp_cadj_Log2             &lt;dbl&gt; -4.0318622, -6.4363044, -8.9539158, -5.08…
$ hs_dmp_madj_Log2             &lt;dbl&gt; 2.9433574, 2.1942911, 2.9433574, 3.293906…
$ hs_dmtp_cadj_Log2            &lt;dbl&gt; 0.8459927, 1.9233638, 3.0682471, -5.10521…
$ hs_dmtp_madj_Log2            &lt;dbl&gt; 4.10736093, 1.20021121, 4.10736093, 3.576…
$ hs_pbde153_cadj_Log2         &lt;dbl&gt; -7.8475381, -1.2116525, -7.2844585, -9.32…
$ hs_pbde153_madj_Log2         &lt;dbl&gt; -0.03209840, -0.72344958, -0.72344958, -1…
$ hs_pbde47_cadj_Log2          &lt;dbl&gt; -8.9728400, -2.4243205, -2.5066911, -3.44…
$ hs_pbde47_madj_Log2          &lt;dbl&gt; -1.4042180, -0.2313590, -1.8333971, -0.43…
$ hs_pfhxs_c_Log2              &lt;dbl&gt; -2.73320634, -3.48387601, -2.24840988, 1.…
$ hs_pfhxs_m_Log2              &lt;dbl&gt; -0.687707983, -1.549184532, -1.082757875,…
$ hs_pfna_c_Log2               &lt;dbl&gt; -2.48372269, -0.97229214, -0.10643005, -0…
$ hs_pfna_m_Log2               &lt;dbl&gt; -1.1584929, -0.9823236, -0.1497498, 0.362…
$ hs_pfoa_c_Log2               &lt;dbl&gt; -0.05315422, 0.62745590, 0.83831144, 1.07…
$ hs_pfoa_m_Log2               &lt;dbl&gt; -0.3632912, -2.2728850, 0.4106915, 2.2795…
$ hs_pfos_c_Log2               &lt;dbl&gt; -0.38337839, -0.04316422, 0.55768510, 3.0…
$ hs_pfos_m_Log2               &lt;dbl&gt; 0.2179881, 2.1738486, 2.3952115, 4.019819…
$ hs_pfunda_c_Log2             &lt;dbl&gt; -4.000194, -5.178933, -5.577692, -2.24362…
$ hs_pfunda_m_Log2             &lt;dbl&gt; -3.2250079, -2.4030518, -0.7264510, -2.91…
$ hs_bpa_cadj_Log2             &lt;dbl&gt; 2.4772244, 2.3889213, 2.1961708, 2.244282…
$ hs_bpa_madj_Log2             &lt;dbl&gt; 0.05551944, 0.29199592, 1.06476036, 2.094…
$ hs_bupa_cadj_Log2            &lt;dbl&gt; -1.9910343, -1.9327542, -3.9561076, -5.73…
$ hs_bupa_madj_Log2            &lt;dbl&gt; 1.7825148, 1.7825148, -2.2540446, -1.7875…
$ hs_etpa_cadj_Log2            &lt;dbl&gt; 0.25162413, 0.52518659, -1.46796280, -0.7…
$ hs_etpa_madj_Log2            &lt;dbl&gt; 5.79901555, 3.28026401, 5.37589705, -1.32…
$ hs_mepa_cadj_Log2            &lt;dbl&gt; 3.3022934, 1.8018050, 2.5656644, 6.542008…
$ hs_mepa_madj_Log2            &lt;dbl&gt; 8.1331356, 9.2005475, 8.1331356, 1.785878…
$ hs_oxbe_cadj_Log2            &lt;dbl&gt; -0.30053896, -1.55772770, -0.43999936, -2…
$ hs_oxbe_madj_Log2            &lt;dbl&gt; 6.7364323, 0.6546953, 1.8318678, 2.754110…
$ hs_prpa_cadj_Log2            &lt;dbl&gt; -4.92777202, -0.01703175, -5.70004580, -1…
$ hs_prpa_madj_Log2            &lt;dbl&gt; 7.0527639, 6.3297033, 6.7250904, 2.941532…
$ hs_trcs_cadj_Log2            &lt;dbl&gt; -0.265468775, -1.860420545, -1.400197798,…
$ hs_trcs_madj_Log2            &lt;dbl&gt; 8.01825911, -0.17483361, -0.17483361, 4.6…
$ hs_mbzp_cadj_Log2            &lt;dbl&gt; 3.3532699, 5.6637287, 3.3272966, 0.695401…
$ hs_mbzp_madj_Log2            &lt;dbl&gt; 3.24276315, 1.86067981, 4.77905012, 3.034…
$ hs_mecpp_cadj_Log2           &lt;dbl&gt; 6.815175, 4.950059, 5.009923, 4.338707, 5…
$ hs_mecpp_madj_Log2           &lt;dbl&gt; 5.874621, 4.741951, 4.850658, 6.346643, 5…
$ hs_mehhp_cadj_Log2           &lt;dbl&gt; 5.043494, 4.857453, 4.227012, 2.879596, 4…
$ hs_mehhp_madj_Log2           &lt;dbl&gt; 4.012001, 4.391042, 4.067675, 5.608232, 3…
$ hs_mehp_cadj_Log2            &lt;dbl&gt; 1.0129893, 1.6884226, 1.0204371, 0.486090…
$ hs_mehp_madj_Log2            &lt;dbl&gt; 3.5077481, 1.7013323, 1.7469755, 2.453339…
$ hs_meohp_cadj_Log2           &lt;dbl&gt; 4.992377, 4.549745, 3.473975, 2.653729, 3…
$ hs_meohp_madj_Log2           &lt;dbl&gt; 3.649581, 4.360200, 3.532362, 4.700827, 2…
$ hs_mep_cadj_Log2             &lt;dbl&gt; 4.168832, 6.025384, 3.861531, 3.575644, 8…
$ hs_mep_madj_Log2             &lt;dbl&gt; 7.123924, 8.910995, 8.400838, 5.821934, 1…
$ hs_mibp_cadj_Log2            &lt;dbl&gt; 6.782071, 6.195669, 6.154459, 5.426139, 5…
$ hs_mibp_madj_Log2            &lt;dbl&gt; 4.433047, 6.083043, 4.976039, 5.626695, 4…
$ hs_mnbp_cadj_Log2            &lt;dbl&gt; 6.960653, 5.755960, 4.464226, 5.616907, 5…
$ hs_mnbp_madj_Log2            &lt;dbl&gt; 4.788463, 3.839804, 4.788463, 4.842579, 4…
$ hs_ohminp_cadj_Log2          &lt;dbl&gt; 3.8445765, 2.0643701, 2.6980526, 1.075322…
$ hs_ohminp_madj_Log2          &lt;dbl&gt; 0.02350192, -0.90016327, -0.56501743, 0.6…
$ hs_oxominp_cadj_Log2         &lt;dbl&gt; 2.08084891, 0.49145227, 1.39715783, 1.535…
$ hs_oxominp_madj_Log2         &lt;dbl&gt; -0.6964288, -0.6939739, -0.6964288, 3.774…
$ hs_sumDEHP_cadj_Log2         &lt;dbl&gt; 5.923815, 7.401802, 5.810282, 5.358708, 6…
$ hs_sumDEHP_madj_Log2         &lt;dbl&gt; 5.805357, 5.805357, 5.774054, 7.227603, 4…
$ FAS_cat_None                 &lt;fct&gt; Middle, Middle, Middle, High, Low, Middle…
$ hs_contactfam_3cat_num_None  &lt;fct&gt; Once a week, (almost) Daily, Once a week,…
$ hs_hm_pers_None              &lt;dbl&gt; 3, 4, 4, 3, 4, 4, 4, 3, 4, 5, 5, 4, 3, 4,…
$ hs_participation_3cat_None   &lt;fct&gt; 1 organisation, 1 organisation, None, Non…
$ e3_asmokcigd_p_None          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ hs_cotinine_cdich_None       &lt;fct&gt; Undetected, Undetected, Undetected, Undet…
$ hs_cotinine_mcat_None        &lt;fct&gt; Smokers, Smokers, Smokers, Non-smokers, N…
$ hs_globalexp2_None           &lt;fct&gt; exposure, no exposure, no exposure, expos…
$ hs_smk_parents_None          &lt;fct&gt; both, neither, one, one, neither, neither…
$ h_distinvnear1_preg_Log      &lt;dbl&gt; -5.629052, -5.045588, -4.204225, -3.08801…
$ h_trafload_preg_pow1over3    &lt;dbl&gt; 0.3458301, 0.3458301, 145.5727586, 187.12…
$ h_trafnear_preg_pow1over3    &lt;dbl&gt; 21.213987, 22.649684, 25.549436, 22.74385…
$ hs_trafload_h_pow1over3      &lt;dbl&gt; 135.99576, 97.88442, 127.53614, 114.86848…
$ hs_trafnear_h_pow1over3      &lt;dbl&gt; 24.914911, 27.905292, 29.299706, 22.74385…
$ h_bro_preg_Log               &lt;dbl&gt; -2.9759296, -2.9759296, -1.6044503, 2.748…
$ h_clf_preg_Log               &lt;dbl&gt; -0.5367134, 1.0787497, 1.1887577, 3.63681…
$ h_thm_preg_Log               &lt;dbl&gt; 0.2880726, 3.1954784, 3.0239239, 3.839335…
$ h_cohort                     &lt;fct&gt; 4, 4, 4, 2, 3, 1, 2, 1, 2, 1, 1, 3, 2, 2,…
$ e3_sex_None                  &lt;fct&gt; male, male, male, female, male, female, m…
$ e3_yearbir_None              &lt;fct&gt; 2008, 2007, 2008, 2005, 2005, 2007, 2003,…
$ h_mbmi_None                  &lt;dbl&gt; 25.51020, 26.49151, 30.11621, 21.04805, 2…
$ hs_wgtgain_None              &lt;dbl&gt; 17, 18, 11, 21, 20, 30, 20, 20, 12, 9, 10…
$ e3_gac_None                  &lt;dbl&gt; 41.00000, 41.00000, 39.00000, 39.28571, 4…
$ h_age_None                   &lt;dbl&gt; 28.00000, 22.84155, 34.23242, 32.72553, 2…
$ h_edumc_None                 &lt;fct&gt; 2, 3, 3, 1, 1, 3, 1, 2, 2, 1, 3, 3, 3, 2,…
$ h_native_None                &lt;fct&gt; 2, 2, 2, 2, 2, 2, 2, 0, 2, 1, 0, 2, 2, 2,…
$ h_parity_None                &lt;fct&gt; 0, 1, 1, 1, 0, 0, 2, 0, 1, 2, 1, 1, 1, 0,…
$ hs_child_age_None            &lt;dbl&gt; 6.165640, 6.992471, 6.110883, 10.138261, …
$ hs_c_height_None             &lt;dbl&gt; 1.220, 1.220, 1.280, 1.345, 1.370, 1.130,…
$ hs_c_weight_None             &lt;dbl&gt; 23.4, 27.6, 37.5, 27.7, 34.0, 21.5, 29.8,…</code></pre>
</div>
</div>
<section id="exposome-descriptive-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exposome-descriptive-analysis"><strong>Exposome descriptive analysis</strong></h2>
<p><img src="https://github.com/alldominguez/isee_young_rennes_ws1/blob/main/figures/Exposome.jpg?raw=1" alt="ISGlobal logo" width="500"></p>
<p>The exposome, described as ‘the totality of human environmental exposures from conception onwards,’acknowledges that individuals are simultaneously exposed to multiple different environmental factors, adopting a holistic approach to discovering etiological factors of disease. The main advantage of the exposome approach over more traditional ’one exposure, one disease or health outcome’ models is that it provides a framework for studying multiple environmental risks (urban, chemical, lifestyle, social, etc.) and their combined effects.</p>
<ul>
<li>Firstly, we will check the <strong>levels</strong> of some pollutants of interest <strong>(Organoclorines, air pollutants, metals)</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Organoclorines levels per cohort</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotFamily</span>(exp,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="st">"Organochlorines"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> <span class="st">"h_cohort"</span>) <span class="sc">+</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">xlab</span>(<span class="st">'Organochlorines'</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ylab</span>(<span class="st">'Concentration'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metals levels per sex</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotFamily</span>(exp,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">family =</span> <span class="st">"Metals"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> <span class="st">"h_cohort"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">xlab</span>(<span class="st">'Metals'</span>) <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">ylab</span>(<span class="st">'Concentration'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>Secondly, we will check the correlation between families <strong>(Organochlorines, air pollution, metals)</strong></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>exp_cor <span class="ot">&lt;-</span> rexposome<span class="sc">::</span><span class="fu">correlation</span>(exp, <span class="at">use =</span> <span class="st">"pairwise.complete.obs"</span>, <span class="at">method.cor =</span> <span class="st">"spearman"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>exp_cor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotCorrelation</span>(exp_cor, <span class="at">type =</span> <span class="st">"matrix"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="exposome-association-analysis-and-variable-selection-methods" class="level3">
<h3 class="anchored" data-anchor-id="exposome-association-analysis-and-variable-selection-methods"><strong>Exposome association analysis and variable selection methods</strong> <a name="association" href=""></a></h3>
<p>Once the exposome variables that we want to study have been explored and described, we can look at the association between some health outcome and the different exposures using different approaches such as those mentioned in the theoretical part.</p>
<ul>
<li><strong>Exposome-Wide association analysis (ExWAS)</strong></li>
</ul>
<p>The ExWAS method is an approach that allows us to deal with high-dimensionality data. This method tests the association of each of the exposures with the health outcome of interest, adjusting for confounding variables (but not for co-exposures), additionally allowing us to control for multiple testing. This method can be applied through the <code>rexposome::exwas</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>exwas <span class="ot">&lt;-</span> rexposome<span class="sc">::</span><span class="fu">exwas</span>(exp, <span class="at">formula =</span> hs_zbmi_who <span class="sc">~</span> h_cohort <span class="sc">+</span> e3_sex_None <span class="sc">+</span> e3_yearbir_None, <span class="at">family =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>exwas</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>An object of class 'ExWAS'

       ~ hs_zbmi_who h_cohort + e3_sex_None + e3_yearbir_None 

Tested exposures:  17 
Threshold for effective tests (TEF):  4.25e-03 
 . Tests &lt; TEF: 0 
Robust standar errors: Computed</code></pre>
</div>
</div>
<p>We obtain the threshold for the effective number of testing (multiple testing): corrected p-value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">tef</span>(exwas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004250246</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>exwas_result <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.data.frame</span>(rexposome<span class="sc">::</span><span class="fu">extract</span>(exwas)),<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>exwas_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                      pvalue    effect      X2.5     X97.5
hs_pcb153_cadj_Log2 0.000000 -0.601448 -0.700145 -0.502751
hs_pcb170_cadj_Log2 0.000000 -0.267357 -0.316641 -0.218073
hs_pcb138_cadj_Log2 0.000000 -0.394363 -0.471809 -0.316917
hs_pcb180_cadj_Log2 0.000000 -0.410830 -0.492683 -0.328976
hs_hcb_cadj_Log2    0.000000 -0.266632 -0.329649 -0.203616
hs_dde_cadj_Log2    0.000000 -0.378716 -0.471500 -0.285933
hs_pcb118_cadj_Log2 0.000000 -0.244863 -0.319822 -0.169905
hs_cu_c_Log2        0.000007  0.182805  0.103212  0.262398
hs_mo_c_Log2        0.000018 -0.125084 -0.182066 -0.068102
hs_cd_c_Log2        0.016039 -0.076952 -0.139502 -0.014401
hs_cs_c_Log2        0.070555  0.096776 -0.008028  0.201579
hs_ddt_cadj_Log2    0.205686 -0.028975 -0.073826  0.015877
hs_co_c_Log2        0.410540 -0.029761 -0.100617  0.041096
hs_hg_c_Log2        0.557572 -0.025847 -0.112209  0.060514
hs_mn_c_Log2        0.597721 -0.023102 -0.108886  0.062683
hs_as_c_Log2        0.673416 -0.004256 -0.024045  0.015532
hs_pb_c_Log2        0.763546 -0.015896 -0.119442  0.087650</code></pre>
</div>
</div>
<p>Using the <code>rexposome::plotExwas</code> function we can visualize the exwas results using a Manhattan plot. This type of graph is particularly useful since it allows us to visualize the statistical association through the p-value grouped by the different exposure families. It is important to mention that the Manhattan plot only shows us the p-values, but no metric of the effect of the exposure.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>clr <span class="ot">&lt;-</span> <span class="fu">rainbow</span>(<span class="fu">length</span>(rexposome<span class="sc">::</span><span class="fu">familyNames</span>(exp)))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(clr) <span class="ot">&lt;-</span> rexposome<span class="sc">::</span><span class="fu">familyNames</span>(exp)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotExwas</span>(exwas, <span class="at">color =</span> clr, <span class="at">show.effective =</span> <span class="cn">TRUE</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">exp.order=</span>expo.list) <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Exposome-Wide Association para BMI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Question 1:</strong> <font color="green"> <strong>Is ExWas analysis controlled by multiple testing?</strong> </font></li>
<li><strong>Question 2:</strong> <font color="green"> <strong>If any participant is exposed to PCB153, can we say that if they are also exposed to PCB118 their BMI will be reduced?</strong> </font></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotEffect</span>(exwas) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">"Exposome and BMI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>rexposome<span class="sc">::</span><span class="fu">plotVolcano</span>(exwas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><strong>Stepwise selection</strong></li>
</ul>
<p>This technique uses a sequence of steps to allow predictor variables to enter or exit a regression model one by one (generates multiple models). Often this procedure converges on a subset of variables. The entry and exit criteria are based on the significance of the p-value. The importance of features is ranked according to their individual ability to explain variation in the outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">234</span>) <span class="co">#definimos una semilla</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(hs_zbmi_who <span class="sc">~</span> h_cohort <span class="sc">+</span> e3_sex_None <span class="sc">+</span> e3_yearbir_None <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                   hs_as_c_Log2 <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                   hs_cd_c_Log2 <span class="sc">+</span> hs_co_c_Log2 <span class="sc">+</span> hs_cs_c_Log2 <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                   hs_cu_c_Log2 <span class="sc">+</span> hs_hg_c_Log2 <span class="sc">+</span> hs_mn_c_Log2 <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                   hs_mo_c_Log2 <span class="sc">+</span> hs_pb_c_Log2 <span class="sc">+</span> hs_dde_cadj_Log2 <span class="sc">+</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                   hs_ddt_cadj_Log2 <span class="sc">+</span> hs_hcb_cadj_Log2<span class="sc">+</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                   hs_pcb118_cadj_Log2 <span class="sc">+</span> hs_pcb138_cadj_Log2<span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>                   hs_pcb153_cadj_Log2 <span class="sc">+</span> hs_pcb170_cadj_Log2 <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>                   hs_pcb180_cadj_Log2,</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>step.model <span class="ot">&lt;-</span> <span class="fu">stepAIC</span>(full.model, <span class="at">direction =</span> <span class="st">"both"</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">trace =</span> <span class="cn">FALSE</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> <span class="sc">~</span> h_cohort <span class="sc">+</span> e3_sex_None <span class="sc">+</span> e3_yearbir_None))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(step.model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hs_zbmi_who ~ h_cohort + e3_sex_None + e3_yearbir_None + 
    hs_cs_c_Log2 + hs_cu_c_Log2 + hs_hg_c_Log2 + hs_mo_c_Log2 + 
    hs_pb_c_Log2 + hs_dde_cadj_Log2 + hs_hcb_cadj_Log2 + hs_pcb118_cadj_Log2 + 
    hs_pcb153_cadj_Log2 + hs_pcb170_cadj_Log2, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5791 -0.6525 -0.0229  0.6495  3.7260 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)         -3.63745    1.34631  -2.702 0.006988 ** 
h_cohort2            0.48885    0.28905   1.691 0.091042 .  
h_cohort3            1.43690    0.22534   6.377 2.53e-10 ***
h_cohort4            1.15351    0.13629   8.463  &lt; 2e-16 ***
h_cohort5            0.87581    0.21509   4.072 4.95e-05 ***
h_cohort6            0.86068    0.11969   7.191 1.09e-12 ***
e3_sex_Nonemale      0.18518    0.05884   3.147 0.001688 ** 
e3_yearbir_None2004 -0.23106    0.17366  -1.331 0.183584    
e3_yearbir_None2005 -0.11822    0.22402  -0.528 0.597796    
e3_yearbir_None2006 -0.10488    0.24560  -0.427 0.669421    
e3_yearbir_None2007  0.25216    0.29888   0.844 0.398991    
e3_yearbir_None2008  0.36477    0.31329   1.164 0.244505    
e3_yearbir_None2009  0.67538    0.42534   1.588 0.112564    
hs_cs_c_Log2         0.18605    0.05242   3.550 0.000400 ***
hs_cu_c_Log2         0.15381    0.03890   3.954 8.12e-05 ***
hs_hg_c_Log2        -0.08692    0.04350  -1.998 0.045918 *  
hs_mo_c_Log2        -0.10055    0.02622  -3.835 0.000132 ***
hs_pb_c_Log2        -0.12676    0.04897  -2.589 0.009745 ** 
hs_dde_cadj_Log2    -0.24946    0.05350  -4.663 3.45e-06 ***
hs_hcb_cadj_Log2    -0.20065    0.04166  -4.816 1.64e-06 ***
hs_pcb118_cadj_Log2  0.12728    0.05282   2.410 0.016108 *  
hs_pcb153_cadj_Log2 -0.34443    0.08198  -4.201 2.84e-05 ***
hs_pcb170_cadj_Log2 -0.15445    0.02796  -5.523 4.02e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.042 on 1278 degrees of freedom
Multiple R-squared:  0.2466,    Adjusted R-squared:  0.2336 
F-statistic: 19.01 on 22 and 1278 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li><strong>Elastic net</strong></li>
</ul>
<p>This technique is based on the combination of the LASSO and Ridge penalties, with the aim of overcoming some of their limitations. Because in the presence of correlated variables LASSO tends to select one variable from a group and ignore the rest and Ridge selects some variables with similar magnitudes, a good compromise is achieved by using Elastic net. The penalty parameters are optimized through the cross-validation procedure (which can generate problems of instability in the results).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(hs_zbmi_who <span class="sc">~</span> h_cohort <span class="sc">+</span> e3_sex_None <span class="sc">+</span> e3_yearbir_None <span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                     hs_as_c_Log2 <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    hs_cd_c_Log2 <span class="sc">+</span> hs_co_c_Log2 <span class="sc">+</span> hs_cs_c_Log2 <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    hs_cu_c_Log2 <span class="sc">+</span> hs_hg_c_Log2 <span class="sc">+</span> hs_mn_c_Log2 <span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                    hs_mo_c_Log2 <span class="sc">+</span> hs_pb_c_Log2 <span class="sc">+</span> hs_dde_cadj_Log2 <span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>                    hs_ddt_cadj_Log2 <span class="sc">+</span> hs_hcb_cadj_Log2<span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>                    hs_pcb118_cadj_Log2 <span class="sc">+</span> hs_pcb138_cadj_Log2<span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>                    hs_pcb153_cadj_Log2 <span class="sc">+</span> hs_pcb170_cadj_Log2 <span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>                    hs_pcb180_cadj_Log2, data)[,<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>pen.fac <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">12</span>),<span class="fu">rep</span>(<span class="dv">1</span>,<span class="fu">ncol</span>(x)<span class="sc">-</span><span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">train</span>(<span class="at">x=</span>x, <span class="at">y=</span>data<span class="sc">$</span>hs_zbmi_who,</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"glmnet"</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> caret<span class="sc">::</span><span class="fu">trainControl</span>(<span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">10</span>, <span class="at">penalty.factor=</span>pen.fac</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Best tuning parameter</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span>bestTune</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  alpha    lambda
9   0.1 0.1284352</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient of the final model. You need</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to specify the best lambda</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(model<span class="sc">$</span>finalModel, model<span class="sc">$</span>bestTune<span class="sc">$</span>lambda)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30 x 1 sparse Matrix of class "dgCMatrix"
                              s1
(Intercept)         -2.414136267
h_cohort2            0.556491729
h_cohort3            1.373932203
h_cohort4            1.092489715
h_cohort5            0.844290433
h_cohort6            0.819200823
e3_sex_Nonemale      0.175764634
e3_yearbir_None2004 -0.237303730
e3_yearbir_None2005 -0.159201895
e3_yearbir_None2006 -0.155507162
e3_yearbir_None2007  0.178018352
e3_yearbir_None2008  0.283899592
e3_yearbir_None2009  0.588977069
hs_as_c_Log2         .          
hs_cd_c_Log2        -0.007510719
hs_co_c_Log2        -0.012568927
hs_cs_c_Log2         0.093654734
hs_cu_c_Log2         0.099593875
hs_hg_c_Log2        -0.028850791
hs_mn_c_Log2         .          
hs_mo_c_Log2        -0.066169352
hs_pb_c_Log2        -0.055575633
hs_dde_cadj_Log2    -0.184889905
hs_ddt_cadj_Log2     .          
hs_hcb_cadj_Log2    -0.139623790
hs_pcb118_cadj_Log2  .          
hs_pcb138_cadj_Log2 -0.048069758
hs_pcb153_cadj_Log2 -0.178770282
hs_pcb170_cadj_Log2 -0.108119397
hs_pcb180_cadj_Log2 -0.072719593</code></pre>
</div>
</div>
<p>Variables that have a <strong>dot (.)</strong> instead of a coefficient have been excluded by the method; These coefficients have been reduced to zero and are not part of the final model. This indicates that, according to the model, they do not provide information that significantly improves the prediction capacity of the model given the current regularization parameters and the information contained in the other variables.</p>
<ul>
<li><strong>Deletion Substitution Addition (DSA)</strong> It is a technique based on multiple iterations through the use of cross-validation, where a variable is removed, replaced or added to the model. Like the previous technique, it is subject to unstable results.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(partDSA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>control <span class="ot">&lt;-</span> partDSA<span class="sc">::</span><span class="fu">DSA.control</span>(<span class="at">vfold=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model_dsa <span class="ot">&lt;-</span> partDSA<span class="sc">::</span><span class="fu">partDSA</span>(x, data<span class="sc">$</span>hs_zbmi_who, <span class="at">control =</span> control)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_dsa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  Length Class  Mode     
cut.off.growth        1  -none- numeric  
minsplit              1  -none- numeric  
minbuck               1  -none- numeric  
MPD                   1  -none- numeric  
IkPn                 10  -none- list     
coefficients         10  -none- list     
IkPn.risks           10  -none- list     
var.levels           29  -none- list     
var.names            29  -none- character
var.importance      290  -none- numeric  
options               2  -none- list     
y.levels              0  -none- NULL     
tablist              10  -none- list     
datalist             10  -none- list     
x                     0  -none- NULL     
y                     0  -none- NULL     
mean.cv.risk.DSA     10  -none- numeric  
sd.cv.risk           10  -none- numeric  
pred.test.set.DSA 13010  -none- numeric  
test.set.risk.DSA    10  -none- numeric  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>model_dsa<span class="sc">$</span>var.importance <span class="co"># we se that some variables appears in different partions of the</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    COG=1 COG=2 COG=3 COG=4 COG=5 COG=6 COG=7 COG=8 COG=9
h_cohort2               0     0     0     0     0     0     0     0     0
h_cohort3               0     0     0     2     3     4     4     5     6
h_cohort4               0     0     0     0     2     3     3     4     4
h_cohort5               0     0     0     0     0     0     0     0     0
h_cohort6               0     0     0     0     0     0     2     2     2
e3_sex_Nonemale         0     0     0     0     0     0     0     0     0
e3_yearbir_None2004     0     0     0     0     0     0     0     0     0
e3_yearbir_None2005     0     0     0     0     0     0     0     0     0
e3_yearbir_None2006     0     0     0     0     0     0     0     0     0
e3_yearbir_None2007     0     0     0     0     0     0     0     0     0
e3_yearbir_None2008     0     0     0     0     0     0     0     0     0
e3_yearbir_None2009     0     0     0     0     0     0     0     0     0
hs_as_c_Log2            0     0     0     0     0     0     0     0     0
hs_cd_c_Log2            0     0     0     0     0     0     0     0     0
hs_co_c_Log2            0     0     0     0     0     0     0     0     0
hs_cs_c_Log2            0     0     0     0     0     0     0     0     0
hs_cu_c_Log2            0     0     0     0     0     0     0     0     0
hs_hg_c_Log2            0     0     0     0     0     0     0     0     0
hs_mn_c_Log2            0     0     0     0     0     0     0     0     0
hs_mo_c_Log2            0     0     0     0     0     0     0     0     0
hs_pb_c_Log2            0     0     0     0     0     0     0     0     0
hs_dde_cadj_Log2        0     0     0     0     0     0     0     2     2
hs_ddt_cadj_Log2        0     0     0     0     0     0     0     0     0
hs_hcb_cadj_Log2        0     2     3     4     5     6     7     8     9
hs_pcb118_cadj_Log2     0     0     0     0     0     0     0     0     2
hs_pcb138_cadj_Log2     0     0     0     0     0     2     2     3     3
hs_pcb153_cadj_Log2     0     0     0     0     0     0     0     0     0
hs_pcb170_cadj_Log2     0     0     2     3     4     5     5     6     7
hs_pcb180_cadj_Log2     0     0     0     0     0     0     0     0     0
                    COG=10
h_cohort2                0
h_cohort3                6
h_cohort4                4
h_cohort5                0
h_cohort6                3
e3_sex_Nonemale          0
e3_yearbir_None2004      0
e3_yearbir_None2005      0
e3_yearbir_None2006      0
e3_yearbir_None2007      0
e3_yearbir_None2008      0
e3_yearbir_None2009      0
hs_as_c_Log2             0
hs_cd_c_Log2             0
hs_co_c_Log2             0
hs_cs_c_Log2             0
hs_cu_c_Log2             2
hs_hg_c_Log2             0
hs_mn_c_Log2             0
hs_mo_c_Log2             0
hs_pb_c_Log2             0
hs_dde_cadj_Log2         2
hs_ddt_cadj_Log2         0
hs_hcb_cadj_Log2        10
hs_pcb118_cadj_Log2      2
hs_pcb138_cadj_Log2      3
hs_pcb153_cadj_Log2      0
hs_pcb170_cadj_Log2      7
hs_pcb180_cadj_Log2      0</code></pre>
</div>
</div>
</section>
</section>
<section id="mixture-analysis" class="level2">
<h2 class="anchored" data-anchor-id="mixture-analysis"><strong>Mixture analysis</strong></h2>
<p>The main idea in mixture analysis is that low levels of exposure to a given contaminant may produce no health effects (or effects that are too small to be detected), but combined exposure to multiple contaminants can generate an effect.</p>
<p><img src="https://github.com/alldominguez/isee_young_rennes_ws1/blob/main/figures/PRIME.png?raw=1" alt="ISGlobal logo" width="500"></p>
<p>Common approaches used in environmental epidemiology (“one-at-the-time”) fail to capture the complexity when evaluating the combined effect of multiple exposures.Therefore, other methods are needed to investigate the health effects of mixtures or multiple exposures. In recent years, various methods have been proposed to estimate the independent and joint effects of multiple exposures.</p>
<p>The selection of the <strong>correct method</strong> in <strong>mixture analysis</strong> should be guided by the <strong>research question we want to answer</strong>.</p>
<ul>
<li><font color="purple"> <strong>Overall effect estimation:</strong> <font color="black"> What is the overall effect of the mixture and what is the magnitude of association?.</font></font></li><font color="purple"><font color="black">
<li><font color="orange"> <strong>Toxic agent identification:</strong> <font color="black"> Which pollutants are associated with the outcome? What pollutants are most important?.</font></font></li><font color="orange"><font color="black">
<li><font color="green"> <strong>Pattern identification:</strong> <font color="black"> Are there specific exposure patterns in the data?.</font></font></li><font color="green"><font color="black">
<li><font color="red"> <strong>A priori defined groups:</strong> <font color="black"> What are the associations between an outcome and a priori defined groups of exposures?.</font></font></li><font color="red"><font color="black">
<li><font color="blue"> <strong>Interactions &amp; Non-linearities:</strong> <font color="black"> Are there interactions between exposures? Is the exposure-response surface non-linear?.</font></font></li><font color="blue"><font color="black">
</font></font></font></font></font></font></font></font></font></font></ul><font color="purple"><font color="orange"><font color="green"><font color="black"><font color="red"><font color="black"><font color="blue"><font color="black">
<p>For a comprehensive review <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8835015/">“Powering Research through Innovative Methods for Mixtures in Epidemiology (PRIME) Program: Novel and Expanded Statistical Methods”</a></p>
<p>We will install the necessary packages to run a mixture analysis</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(gWQS, qgcomp, bkmr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To facilitate the interpretation of the results we only going to use one family for the mixture analysis. We create a subset only for organochlorines during the postnatal period.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> <span class="fu">as.character</span>(codebook<span class="sc">$</span>variable_name[(codebook<span class="sc">$</span>family <span class="sc">==</span> <span class="st">"Organochlorines"</span> <span class="sc">|</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>                                                  codebook<span class="sc">$</span>family <span class="sc">==</span> <span class="st">"Metals"</span>) <span class="sc">&amp;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>                                                  codebook<span class="sc">$</span>period <span class="sc">==</span> <span class="st">"Postnatal"</span>])</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> expo.list[<span class="sc">-</span><span class="fu">which</span>(expo.list <span class="sc">==</span> <span class="st">"hs_tl_cdich_None"</span>)] <span class="co">#since it is a factor</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>expo.list <span class="ot">&lt;-</span> expo.list[<span class="sc">-</span><span class="fu">which</span>(expo.list <span class="sc">==</span> <span class="st">"hs_sumPCBs5_cadj_Log2"</span>)] <span class="co">#since it is a sum of PCBs already</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>expo2 <span class="ot">&lt;-</span> exposome[ ,<span class="fu">c</span>(<span class="st">"ID"</span>, expo.list)]</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="at">hs_zbmi_who =</span> phenotype[ ,<span class="dv">4</span>],  <span class="co"># we select the fourth column of the phenotype dataframe and name it hs_zbmi_who</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>             covariates[ ,<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>])  <span class="co"># we select columns 2 through 13 of the covariates dataframe</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a><span class="co"># we combine the data</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(expo2, dat)</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1301 obs. of  31 variables:
 $ ID                 : int  1 2 3 4 5 6 7 8 9 10 ...
 $ hs_as_c_Log2       : num  -4.283 -6.43 -7.978 0.632 0.651 ...
 $ hs_cd_c_Log2       : num  -4.14 -4.25 -4.05 -5.26 -3.75 ...
 $ hs_co_c_Log2       : num  1.02 -2.62 -2.56 -3 -1.61 ...
 $ hs_cs_c_Log2       : num  0.251 0.202 0.39 0.669 0.903 ...
 $ hs_cu_c_Log2       : num  9.71 9.94 9.93 10.19 9.44 ...
 $ hs_hg_c_Log2       : num  -2.152 -1.3 -0.911 1.48 2.862 ...
 $ hs_mn_c_Log2       : num  3.46 2.88 3 3.22 2.88 ...
 $ hs_mo_c_Log2       : num  0.949 1.07 -0.484 -5.866 -0.252 ...
 $ hs_pb_c_Log2       : num  3.63 3.41 2.82 3.17 3.63 ...
 $ hs_dde_cadj_Log2   : num  6.93 4.6 5.96 4.49 3.87 ...
 $ hs_ddt_cadj_Log2   : num  0.297 0.768 1.453 1.526 -0.719 ...
 $ hs_hcb_cadj_Log2   : num  3.93 3.77 4.82 3.3 2.13 ...
 $ hs_pcb118_cadj_Log2: num  1.298 1.275 1.662 1.372 0.143 ...
 $ hs_pcb138_cadj_Log2: num  2.35 2.33 2.66 3.78 1.65 ...
 $ hs_pcb153_cadj_Log2: num  3.25 3.82 3.95 4.75 2.63 ...
 $ hs_pcb170_cadj_Log2: num  0.0821 -0.5204 0.6573 1.0224 -0.8202 ...
 $ hs_pcb180_cadj_Log2: num  1.408 0.698 2.294 3.34 0.562 ...
 $ hs_zbmi_who        : num  0.3 0.41 3.33 -0.76 0.98 -0.08 0.04 -0.1 -1.78 1.75 ...
 $ h_cohort           : Factor w/ 6 levels "1","2","3","4",..: 4 4 4 2 3 1 2 1 2 1 ...
 $ e3_sex_None        : Factor w/ 2 levels "female","male": 2 2 2 1 2 1 2 1 1 1 ...
 $ e3_yearbir_None    : Factor w/ 7 levels "2003","2004",..: 6 5 6 3 3 5 1 6 2 6 ...
 $ h_mbmi_None        : num  25.5 26.5 30.1 21 22.2 ...
 $ hs_wgtgain_None    : num  17 18 11 21 20 30 20 20 12 9 ...
 $ e3_gac_None        : num  41 41 39 39.3 43 ...
 $ h_age_None         : num  28 22.8 34.2 32.7 20.9 ...
 $ h_edumc_None       : Factor w/ 3 levels "1","2","3": 2 3 3 1 1 3 1 2 2 1 ...
 $ h_native_None      : Factor w/ 3 levels "0","1","2": 3 3 3 3 3 3 3 1 3 2 ...
 $ h_parity_None      : Factor w/ 3 levels "0","1","2": 1 2 2 2 1 1 3 1 2 3 ...
 $ hs_child_age_None  : num  6.17 6.99 6.11 10.14 9.45 ...
 $ hs_c_height_None   : num  1.22 1.22 1.28 1.34 1.37 ...</code></pre>
</div>
</div>
<ul>
<li><strong>Weighted Quantile Sum Regression (WQS)</strong></li>
</ul>
<p>This method operates in a supervised learning framework, creating a single score (the weighted quantile sum) that summarizes the overall exposure to the mixture and including this score in a regression model. It aims to evaluate the overall effect of the mixture on the outcome of interest. The score is calculated as a weighted sum (so that exposures with weaker effects on the outcome have less weight in the index) of all exposures categorized into quartiles, or more groups, so that extreme values have less impact on the outcome (weight estimation).</p>
<p>To estimate the model, the data is split in a training and validation dataset: the training set is used for the weights estimation, the second one to test for the significance of the final WQS index. The weights are estimated through a bootstrap sample (a dataset is created using sampling replacement from the training dataset and the parameters are estimated using an optimization algorithm).</p>
<p>After the weights are estimated in the training dataset this are used to construct the WQS index in the validation set, which are used to test for the association between the mixture and the health outcome.</p>
<p>The coefficient that summarize the overall effect to the (weighted) mixture will be <code>wqs</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>mod_wqs <span class="ot">&lt;-</span> <span class="fu">gwqs</span>(hs_zbmi_who <span class="sc">~</span> wqs <span class="sc">+</span> h_cohort <span class="sc">+</span> e3_sex_None <span class="sc">+</span> e3_yearbir_None, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">mix_name =</span> expo.list, </span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">q =</span> <span class="dv">10</span>, <span class="co"># wqs will be estimted from ranking exposure concentration in deciles</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">validation =</span> <span class="fl">0.6</span>, <span class="co"># 0.40 will be used for training</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">b =</span> <span class="dv">100</span>, <span class="co"># 100 bootsrap samples</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">b1_pos =</span> <span class="cn">FALSE</span>, <span class="co"># negative weights </span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">b_constr =</span> <span class="cn">FALSE</span>, <span class="co"># contraints in the optimization function for weight est.</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="st">"gaussian"</span>, </span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">seed =</span> <span class="dv">2016</span>,</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After we run the model, we can test the significance of the mixture coefficient to see if there is an association between the WQS index and the outcome (BMI)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_wqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
gwqs(formula = hs_zbmi_who ~ wqs + h_cohort + e3_sex_None + e3_yearbir_None, 
    data = data, mix_name = expo.list, b = 100, b1_pos = FALSE, 
    b_constr = FALSE, q = 10, validation = 0.6, family = "gaussian", 
    seed = 2016)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.0405  -0.6986  -0.0671   0.6531   3.3103  

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)          1.08937    0.39388   2.766  0.00582 ** 
wqs                 -0.33388    0.02475 -13.489  &lt; 2e-16 ***
h_cohort2            0.34555    0.35337   0.978  0.32846    
h_cohort3            1.52068    0.27065   5.619 2.71e-08 ***
h_cohort4            1.39655    0.15303   9.126  &lt; 2e-16 ***
h_cohort5            1.14741    0.25474   4.504 7.72e-06 ***
h_cohort6            0.85468    0.13820   6.184 1.02e-09 ***
e3_sex_Nonemale      0.22126    0.07480   2.958  0.00319 ** 
e3_yearbir_None2004 -0.27893    0.20822  -1.340  0.18078    
e3_yearbir_None2005 -0.33522    0.28244  -1.187  0.23566    
e3_yearbir_None2006 -0.43211    0.30920  -1.397  0.16268    
e3_yearbir_None2007 -0.10966    0.37215  -0.295  0.76833    
e3_yearbir_None2008 -0.03833    0.38967  -0.098  0.92168    
e3_yearbir_None2009  0.25871    0.60059   0.431  0.66677    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 1.04504)

    Null deviance: 1058.24  on 769  degrees of freedom
Residual deviance:  790.05  on 756  degrees of freedom
AIC: 2235

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>In, addition we can also provide an estimate of the individual weights that indicate the relative importance of each exposure in the mixture-outcome associations. This is done by using the following syntax.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gwqs_barplot</span>(mod_wqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Additionally, we can have a representation of the <code>wqs</code> index and the outcome (adjusted model residual when covariates are included in the model). This shows the direction and the shape of the association between the mixture defined previously and BMI. For example, we</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gwqs_scatterplot</span>(mod_wqs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Participants in the top deciles of the selected exposures are those associated with lower BMI.</p>
<p>WQS regression works under the assumption of uni-directionallity (positive or negative) of all exposure with respect to the explored outcome. Under this assumption we seek no to incur in the reversal paradox (under highly correlated exposures) improving the identification of harmful pollutants.</p>
<p><strong>Question:</strong> <font color="green"> <strong>Does the model take into consideration possible interactions?</strong> </font></p>
<p>The WQS regression have several extensions that helps to relaxed some of the assumptions and address some of their limitations. Extensions of the WQS regression are: (i) Repeated holdout validation for WQS, (ii) Penalized weights, (iii) BWQS, (iv) lagged WQS (time-varying mixtures of exposures).</p>
<ul>
<li><strong>Quantile G-computation</strong></li>
</ul>
<p>This method was introduced to overcome some of the limitations in the directionallity assumption from the WQS, while also improving the causal interpretation of the results. The procedure for parameter estimation in Quantile G-computation is the same that the one used for WQS, but instead of using a standard regression uses a marginal structural model. Quantile g-computation yields estimates of the effect of increasing all exposures by one quantile, simultaneously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Preparing qgcomp call</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>list_expo_qgcomp<span class="ot">&lt;-</span><span class="fu">colnames</span>(expo2)[<span class="sc">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>qgcomp_fit <span class="ot">&lt;-</span> <span class="fu">qgcomp</span>(<span class="fu">as.formula</span>(<span class="fu">paste</span>(<span class="st">"hs_zbmi_who ~ h_cohort + e3_sex_None + e3_yearbir_None +"</span>, </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">paste</span>(list_expo_qgcomp, <span class="at">collapse =</span> <span class="st">" + "</span>))), <span class="co"># complete formula including exposures</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">expnms =</span> list_expo_qgcomp, <span class="co">#list of exposures</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> data, </span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">family =</span> <span class="fu">gaussian</span>(), </span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rr =</span> <span class="cn">FALSE</span>) <span class="co">#if using binary outcome and rr=TRUE (default), estimates risk ratio rather than odds ratio</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have a look to the the quantile results</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(qgcomp_fit) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Mixture slope parameters (Delta method CI):</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$coefficients
              Estimate Std. Error   Lower CI   Upper CI     Pr(&gt;|t|)
(Intercept)  0.3245856  0.3264567 -0.3152576  0.9644289 3.202795e-01
psi1        -0.5958490  0.0841154 -0.7607121 -0.4309858 2.307488e-12</code></pre>
</div>
</div>
<p>The mean difference of a quartile increase of the mixture on the outcome is represented by psi1</p>
<p>Now we plot the weights in the mixture analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(qgcomp_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The “weights” in <code>qgcomp</code> correspond to the proportion of the overall effect when all the exposures have effects in the same direction, but otherwise they correspond to the proportion of the effect <em>in a particular direction</em>, which may be small (or large) compared to the overall “mixture” effect. The left and right sides of the plot should not be compared with each other because the length of the bars corresponds to the effect size only relative to other effects in the same direction. The darkness of the bars corresponds to the overall effect size.</p>
<ul>
<li><strong>Bayesian Kernel Machine Regression (BKMR)</strong></li>
</ul>
<p>This method was designed to address, in a flexible non-parametric way, several objectives such as (i) detection and estimation of an effect of the overall mixture, (ii) identification of pollutant or group of pollutants responsible for observed mixture effects, (iii) visualizing the exposure-response function, and (iv) detection of interactions among pollutants within the mixture.</p>
<p>The main idea of BKMR is to model the exposure through means of a kernel function. The kernel function shrinks the estimated health effects of two individuals with similar exposures profiles toward each other.</p>
<p>The estimation is built within an iterative procedure (MCMC), variable importance are provided in terms of posterior inclusion probability (PIP).</p>
<p>The implementation of this technique is relatively straightforward. We need to define an object <strong>containing the mixture</strong> , the <strong>outcome</strong>, and the set of <strong>confounders</strong>. Since we are using an iterative process with a random component, we need to define a <strong>seed</strong>. All continuous variables need to be scaled and categorical with more than 2 levels need to be dichotomous (so a variable with 3 levels will be transformed into 2 variables with 2 levels each).</p>
<ol type="1">
<li>Define the outcome</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>outcome <span class="ot">&lt;-</span> data<span class="sc">$</span>hs_zbmi_who</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Define a list of exposures (mixtures)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>exposures <span class="ot">&lt;-</span> data[,list_expo_qgcomp]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Define a set of covariates to adjust the model</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>covariates <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">cohort_1=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>h_cohort<span class="sc">==</span><span class="st">"1"</span>),<span class="co">#cohort 1 is 1, the others are 0</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cohort_2=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>h_cohort<span class="sc">==</span><span class="st">"2"</span>),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cohort_3=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>h_cohort<span class="sc">==</span><span class="st">"3"</span>),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cohort_4=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>h_cohort<span class="sc">==</span><span class="st">"4"</span>),</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cohort_5=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>h_cohort<span class="sc">==</span><span class="st">"5"</span>),</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sex=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_sex_None<span class="sc">==</span><span class="st">"female"</span>), <span class="co">#female is 1, male is 0</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2003=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2003"</span>),</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2004=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2004"</span>),</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2005=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2005"</span>),</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2006=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2006"</span>),</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2007=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2007"</span>),</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>                    <span class="at">year_2008=</span><span class="fu">as.numeric</span>(data<span class="sc">$</span>e3_yearbir_None<span class="sc">==</span><span class="st">"2008"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model is defined as follows (please do not run the model: it takes 8 hours to run)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#bkmr_fit &lt;- kmbayes(y=outcome,</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#Z=exposures,</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#X=covariates,</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#iter=20000, #number of iterations</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#verbose=TRUE, #text displayed during the processing to show progress</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                      <span class="co">#varsel=TRUE,  #to conduct variable selection</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># family='gaussian')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We going to load the fitted object `bkmr_fit.RData` directly from the repository</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://raw.githubusercontent.com/alldominguez/isee_young_rennes_ws1/main/data/bkmr_fit.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When using multiple iterations, it is important to evaluate the convergence of the parameters. By looking at the convergence graphs we can verify this (we expect random behavior around the straight line). What we generally observe is an initial “burning” phase, which we should eliminate from the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TracePlot</span>(<span class="at">fit =</span> bkmr_fit, <span class="at">par =</span> <span class="st">"beta"</span>) <span class="co">#no specific shape = ok, it's also common to have a big variation at the beginning</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ExtractPIPs</span>(bkmr_fit) <span class="co">#to get the table of posterior inclusion probabilities (= % of iterations where the exposure was included in the model)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              variable    PIP
1         hs_as_c_Log2 0.0839
2         hs_cd_c_Log2 0.0575
3         hs_co_c_Log2 0.0858
4         hs_cs_c_Log2 0.7404
5         hs_cu_c_Log2 1.0000
6         hs_hg_c_Log2 0.0392
7         hs_mn_c_Log2 0.1462
8         hs_mo_c_Log2 0.9020
9         hs_pb_c_Log2 0.6537
10    hs_dde_cadj_Log2 0.7585
11    hs_ddt_cadj_Log2 0.3216
12    hs_hcb_cadj_Log2 1.0000
13 hs_pcb118_cadj_Log2 0.3445
14 hs_pcb138_cadj_Log2 0.1642
15 hs_pcb153_cadj_Log2 0.0971
16 hs_pcb170_cadj_Log2 1.0000
17 hs_pcb180_cadj_Log2 0.0984</code></pre>
</div>
</div>
<p>The overall association of the mixture at different concentration percentiles compared to the 10th percentile and their 95% credible intervals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>sel <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10001</span>,<span class="dv">20000</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># process of burning and thinning (taking every fifth draws in the second half of the iterations) to reduce  auto-correlation between chains</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>overallrisks_10 <span class="ot">&lt;-</span> <span class="fu">OverallRiskSummaries</span>(<span class="at">fit=</span>bkmr_fit, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">qs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.05</span>), </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">q.fixed =</span> <span class="fl">0.1</span>, </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">sel =</span> sel, </span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">method=</span><span class="st">"approx"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(overallrisks_10, <span class="fu">aes</span>(quantile, est, </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ymin =</span> est <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>sd, <span class="at">ymax =</span> est <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>sd)) <span class="sc">+</span>  </span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">00</span>, <span class="at">linetype=</span><span class="st">"dashed"</span>, <span class="at">color=</span><span class="st">"gray"</span>) <span class="sc">+</span> </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">""</span>)<span class="sc">+</span> <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">size =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Quantiles of exposure to the mixture"</span>) <span class="sc">+</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Difference in BMI z-score"</span>)<span class="sc">+</span> </span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">vjust =</span> <span class="dv">3</span>, <span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))<span class="sc">+</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>),<span class="at">linewidth =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also get estimates when comparing the 75th percentile to the 25th</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>overallrisks_25 <span class="ot">&lt;-</span> <span class="fu">OverallRiskSummaries</span>(<span class="at">fit=</span>bkmr_fit, </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">qs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.05</span>), </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">q.fixed =</span> <span class="fl">0.25</span>, </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">sel =</span> sel, </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">method=</span><span class="st">"approx"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>overallrisks_25 <span class="co">#each percentile compared to 25th percentile</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   quantile         est         sd
1      0.10  0.12567981 0.16813197
2      0.15  0.07849073 0.11157797
3      0.20  0.13628955 0.04182048
4      0.25  0.00000000 0.00000000
5      0.30 -0.06706310 0.02435660
6      0.35 -0.12738421 0.05694068
7      0.40 -0.22355246 0.07289141
8      0.45 -0.30442344 0.08536282
9      0.50 -0.41670349 0.09697169
10     0.55 -0.52013079 0.10705752
11     0.60 -0.61312182 0.11543475
12     0.65 -0.71638955 0.12298245
13     0.70 -0.82540378 0.13207616
14     0.75 -0.94393966 0.14272076
15     0.80 -1.08014516 0.16249152
16     0.85 -1.22660588 0.20018492
17     0.90 -1.39812185 0.28178275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>overallrisks_25[<span class="dv">9</span>,<span class="dv">2</span>]<span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span>overallrisks_25[<span class="dv">9</span>,<span class="dv">3</span>] <span class="co">#lower credible interval for median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.226639</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>overallrisks_25[<span class="dv">9</span>,<span class="dv">2</span>]<span class="sc">-</span><span class="fl">1.96</span><span class="sc">*</span>overallrisks_25[<span class="dv">9</span>,<span class="dv">3</span>] <span class="co">#upper credible interval for median</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.606768</code></pre>
</div>
</div>
<p>Exposure response function of a single exposure when all other exposures are fixed at the median level</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>univar <span class="ot">&lt;-</span> <span class="fu">PredictorResponseUnivar</span>(<span class="at">fit =</span> bkmr_fit, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">ngrid =</span> <span class="dv">50</span>, </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">q.fixed =</span> <span class="fl">0.5</span>, </span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">sel =</span> sel, </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">method=</span><span class="st">"approx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(univar, <span class="fu">aes</span>(z, est, <span class="at">ymin =</span> est <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se, <span class="at">ymax =</span> est <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se)) <span class="sc">+</span> </span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">stat =</span> <span class="st">"identity"</span>,<span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Difference in BMI z-score"</span>) <span class="sc">+</span> </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable)<span class="sc">+</span><span class="fu">ggtitle</span>(<span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Z-score of log concentrations of chemicals"</span>) <span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>),<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>),<span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="dv">0</span>, <span class="fl">2.5</span>))<span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">17</span>),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">19</span>),</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">19</span>),</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>),</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">15</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 151 rows containing missing values or values outside the scale range
(`geom_smooth()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Exposure response function of a single exposure where the second exposure is fixed at various quantiles (please do not run the model: it takes 30 minutes to run)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">#pred.resp.bivar &lt;- PredictorResponseBivar(fit = bkmr_fit,</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>                                         <span class="co">#sel = sel,</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>                                         <span class="co">#min.plot.dist = 1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We going to load the fitted object directly `bkmr_pred.resp.bivar.RData` from the repository</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="fu">url</span>(<span class="st">"https://raw.githubusercontent.com/alldominguez/isee_young_rennes_ws1/main/data/bkmr_pred.resp.bivar.RData"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>pred.resp.bivar.levels<span class="ot">&lt;-</span><span class="fu">PredictorResponseBivarLevels</span>(pred.resp.bivar,</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>                                                     exposures, </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>                                                     <span class="at">qs =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pred.resp.bivar.levels, <span class="fu">aes</span> (z1, est)) <span class="sc">+</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">col =</span> quantile), <span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(variable2 <span class="sc">~</span> variable1) <span class="sc">+</span> </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"h(exposure 1 | quantiles of exposure 2)"</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Difference in BMI z-score"</span>)<span class="sc">+</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Exposures 1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 14554 rows containing missing values or values outside the scale range
(`geom_smooth()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Individual effect of a specific exposure (e.g.&nbsp;comparing the 75th to the 25th percentile) when all the others are fixed at a particular percentile (e.g., 25, 50 and 75th percentile)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>risks.singvar <span class="ot">&lt;-</span> <span class="fu">SingVarRiskSummaries</span>(<span class="at">fit =</span> bkmr_fit, </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">sel =</span> sel,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">qs.diff =</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>),</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">q.fixed =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.50</span>,<span class="fl">0.75</span>), </span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">method =</span> <span class="st">"approx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(risks.singvar, <span class="fu">aes</span>(variable, est, </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymin =</span> est<span class="fl">-1.96</span><span class="sc">*</span>sd, </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ymax =</span> est <span class="sc">+</span><span class="fl">1.96</span><span class="sc">*</span>sd , </span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">col =</span> q.fixed)) <span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.75</span>)) <span class="sc">+</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"cyan4"</span>, <span class="st">"mediumblue"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>), <span class="at">linetype=</span><span class="st">"dashed"</span>,<span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Chemicals"</span>) <span class="sc">+</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Difference in BMI z-score"</span>)<span class="sc">+</span> </span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>,<span class="at">vjust=</span><span class="dv">3</span>, <span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color =</span> <span class="st">"Quantiles of </span><span class="sc">\n</span><span class="st"> mixture </span><span class="sc">\n</span><span class="st"> exposure"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="isee_young_exposome_mixtures_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</font></font></font></font></font></font></font></font></section><font color="purple"><font color="orange"><font color="green"><font color="black"><font color="red"><font color="black"><font color="blue"><font color="black">

</font></font></font></font></font></font></font></font></main><font color="purple"><font color="orange"><font color="green"><font color="black"><font color="red"><font color="black"><font color="blue"><font color="black">
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</font></font></font></font></font></font></font></font></div><font color="purple"><font color="orange"><font color="green"><font color="black"><font color="red"><font color="black"><font color="blue"><font color="black"> <!-- /content -->



</font></font></font></font></font></font></font></font></body></html>